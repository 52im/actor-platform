//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/actor-ios/build/java/org/bouncycastle/math/ec/MixedNafR2LMultiplier.java
//

#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/math/BigInteger.h"
#include "org/bouncycastle/math/ec/ECCurve.h"
#include "org/bouncycastle/math/ec/ECPoint.h"
#include "org/bouncycastle/math/ec/MixedNafR2LMultiplier.h"
#include "org/bouncycastle/math/ec/WNafUtil.h"

@implementation OrgBouncycastleMathEcMixedNafR2LMultiplier

- (instancetype)init {
  return [self initOrgBouncycastleMathEcMixedNafR2LMultiplierWithInt:OrgBouncycastleMathEcECCurve_COORD_JACOBIAN withInt:OrgBouncycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED];
}

- (instancetype)initOrgBouncycastleMathEcMixedNafR2LMultiplierWithInt:(jint)additionCoord
                                                              withInt:(jint)doublingCoord {
  if (self = [super init]) {
    self->additionCoord_ = additionCoord;
    self->doublingCoord_ = doublingCoord;
  }
  return self;
}

- (instancetype)initWithInt:(jint)additionCoord
                    withInt:(jint)doublingCoord {
  return [self initOrgBouncycastleMathEcMixedNafR2LMultiplierWithInt:additionCoord withInt:doublingCoord];
}

- (OrgBouncycastleMathEcECPoint *)multiplyPositiveWithOrgBouncycastleMathEcECPoint:(OrgBouncycastleMathEcECPoint *)p
                                                            withJavaMathBigInteger:(JavaMathBigInteger *)k {
  OrgBouncycastleMathEcECCurve *curveOrig = [((OrgBouncycastleMathEcECPoint *) nil_chk(p)) getCurve];
  OrgBouncycastleMathEcECCurve *curveAdd = [self configureCurveWithOrgBouncycastleMathEcECCurve:curveOrig withInt:additionCoord_];
  OrgBouncycastleMathEcECCurve *curveDouble = [self configureCurveWithOrgBouncycastleMathEcECCurve:curveOrig withInt:doublingCoord_];
  IOSIntArray *naf = OrgBouncycastleMathEcWNafUtil_generateCompactNafWithJavaMathBigInteger_(k);
  OrgBouncycastleMathEcECPoint *Ra = [((OrgBouncycastleMathEcECCurve *) nil_chk(curveAdd)) getInfinity];
  OrgBouncycastleMathEcECPoint *Td = [((OrgBouncycastleMathEcECCurve *) nil_chk(curveDouble)) importPointWithOrgBouncycastleMathEcECPoint:p];
  jint zeroes = 0;
  for (jint i = 0; i < ((IOSIntArray *) nil_chk(naf))->size_; ++i) {
    jint ni = IOSIntArray_Get(naf, i);
    jint digit = RShift32(ni, 16);
    zeroes += ni & (jint) 0xFFFF;
    Td = [((OrgBouncycastleMathEcECPoint *) nil_chk(Td)) timesPow2WithInt:zeroes];
    OrgBouncycastleMathEcECPoint *Tj = [curveAdd importPointWithOrgBouncycastleMathEcECPoint:Td];
    if (digit < 0) {
      Tj = [((OrgBouncycastleMathEcECPoint *) nil_chk(Tj)) negate];
    }
    Ra = [((OrgBouncycastleMathEcECPoint *) nil_chk(Ra)) addWithOrgBouncycastleMathEcECPoint:Tj];
    zeroes = 1;
  }
  return [((OrgBouncycastleMathEcECCurve *) nil_chk(curveOrig)) importPointWithOrgBouncycastleMathEcECPoint:Ra];
}

- (OrgBouncycastleMathEcECCurve *)configureCurveWithOrgBouncycastleMathEcECCurve:(OrgBouncycastleMathEcECCurve *)c
                                                                         withInt:(jint)coord {
  if ([((OrgBouncycastleMathEcECCurve *) nil_chk(c)) getCoordinateSystem] == coord) {
    return c;
  }
  if (![c supportsCoordinateSystemWithInt:coord]) {
    @throw [[JavaLangIllegalArgumentException alloc] initWithNSString:JreStrcat("$I$", @"Coordinate system ", coord, @" not supported by this curve")];
  }
  return [((OrgBouncycastleMathEcECCurve_Config *) nil_chk([((OrgBouncycastleMathEcECCurve_Config *) nil_chk([c configure])) setCoordinateSystemWithInt:coord])) create];
}

- (void)copyAllFieldsTo:(OrgBouncycastleMathEcMixedNafR2LMultiplier *)other {
  [super copyAllFieldsTo:other];
  other->additionCoord_ = additionCoord_;
  other->doublingCoord_ = doublingCoord_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgBouncycastleMathEcMixedNafR2LMultiplier)
