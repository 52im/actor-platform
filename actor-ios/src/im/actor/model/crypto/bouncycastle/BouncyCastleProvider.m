//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/actor-ios/build/java/im/actor/model/crypto/bouncycastle/BouncyCastleProvider.java
//

#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "im/actor/model/crypto/AesCipher.h"
#include "im/actor/model/crypto/CryptoKeyPair.h"
#include "im/actor/model/crypto/RsaCipher.h"
#include "im/actor/model/crypto/RsaEncryptCipher.h"
#include "im/actor/model/crypto/bouncycastle/BcAesCipher.h"
#include "im/actor/model/crypto/bouncycastle/BcRsaCipher.h"
#include "im/actor/model/crypto/bouncycastle/BcRsaEncryptCipher.h"
#include "im/actor/model/crypto/bouncycastle/BouncyCastleProvider.h"
#include "im/actor/model/crypto/encoding/PKS8RsaPrivateKey.h"
#include "im/actor/model/crypto/encoding/X509RsaPublicKey.h"
#include "java/math/BigInteger.h"
#include "java/security/SecureRandom.h"
#include "org/bouncycastle/crypto/AsymmetricCipherKeyPair.h"
#include "org/bouncycastle/crypto/digests/MD5Digest.h"
#include "org/bouncycastle/crypto/digests/SHA256Digest.h"
#include "org/bouncycastle/crypto/digests/SHA512Digest.h"
#include "org/bouncycastle/crypto/generators/RSAKeyPairGenerator.h"
#include "org/bouncycastle/crypto/params/AsymmetricKeyParameter.h"
#include "org/bouncycastle/crypto/params/RSAKeyGenerationParameters.h"
#include "org/bouncycastle/crypto/params/RSAKeyParameters.h"
#include "org/bouncycastle/crypto/params/RSAPrivateCrtKeyParameters.h"

@interface BCBouncyCastleProvider () {
}
@end

BOOL BCBouncyCastleProvider_initialized = NO;

@implementation BCBouncyCastleProvider

JavaMathBigInteger * BCBouncyCastleProvider_RSA_EXPONENT_;
JavaMathBigInteger * BCBouncyCastleProvider_ZERO_;
JavaSecuritySecureRandom * BCBouncyCastleProvider_RANDOM_;

- (AMCryptoKeyPair *)generateRSA1024KeyPair {
  OrgBouncycastleCryptoGeneratorsRSAKeyPairGenerator *generator = [[OrgBouncycastleCryptoGeneratorsRSAKeyPairGenerator alloc] init];
  [generator init__WithOrgBouncycastleCryptoKeyGenerationParameters:[[OrgBouncycastleCryptoParamsRSAKeyGenerationParameters alloc] initWithJavaMathBigInteger:BCBouncyCastleProvider_RSA_EXPONENT_ withJavaSecuritySecureRandom:[[JavaSecuritySecureRandom alloc] init] withInt:BCBouncyCastleProvider_RSA_1024_STREIGHT withInt:BCBouncyCastleProvider_RSA_CERTAINITY]];
  OrgBouncycastleCryptoAsymmetricCipherKeyPair *res = [generator generateKeyPair];
  OrgBouncycastleCryptoParamsRSAKeyParameters *rsaPublicKey = (OrgBouncycastleCryptoParamsRSAKeyParameters *) check_class_cast([((OrgBouncycastleCryptoAsymmetricCipherKeyPair *) nil_chk(res)) getPublic], [OrgBouncycastleCryptoParamsRSAKeyParameters class]);
  IOSByteArray *publicKey = [((BCX509RsaPublicKey *) [[BCX509RsaPublicKey alloc] initWithJavaMathBigInteger:[((OrgBouncycastleCryptoParamsRSAKeyParameters *) nil_chk(rsaPublicKey)) getModulus] withJavaMathBigInteger:[rsaPublicKey getExponent]]) serialize];
  OrgBouncycastleCryptoParamsRSAPrivateCrtKeyParameters *parameter = (OrgBouncycastleCryptoParamsRSAPrivateCrtKeyParameters *) check_class_cast([res getPrivate], [OrgBouncycastleCryptoParamsRSAPrivateCrtKeyParameters class]);
  IOSByteArray *privateKey = [((BCPKS8RsaPrivateKey *) [[BCPKS8RsaPrivateKey alloc] initWithJavaMathBigInteger:[((OrgBouncycastleCryptoParamsRSAPrivateCrtKeyParameters *) nil_chk(parameter)) getModulus] withJavaMathBigInteger:[parameter getExponent]]) serialize];
  return [[AMCryptoKeyPair alloc] initWithByteArray:publicKey withByteArray:privateKey];
}

- (id<AMRsaEncryptCipher>)createRSAOAEPSHA1CipherWithByteArray:(IOSByteArray *)key {
  return [[BCBcRsaEncryptCipher alloc] initWithByteArray:key];
}

- (id<AMRsaCipher>)createRSAOAEPSHA1CipherWithByteArray:(IOSByteArray *)publicKey
                                          withByteArray:(IOSByteArray *)privateKey {
  return [[BCBcRsaCipher alloc] initWithByteArray:publicKey withByteArray:privateKey];
}

- (id<AMAesCipher>)createAESCBCPKS7CipherWithByteArray:(IOSByteArray *)key
                                         withByteArray:(IOSByteArray *)iv {
  return [[BCBcAesCipher alloc] initWithByteArray:key withByteArray:iv];
}

- (IOSByteArray *)MD5WithByteArray:(IOSByteArray *)data {
  OrgBouncycastleCryptoDigestsMD5Digest *digest = [[OrgBouncycastleCryptoDigestsMD5Digest alloc] init];
  [digest updateWithByteArray:data withInt:0 withInt:((IOSByteArray *) nil_chk(data))->size_];
  IOSByteArray *res = [IOSByteArray newArrayWithLength:16];
  [digest doFinalWithByteArray:res withInt:0];
  return res;
}

- (IOSByteArray *)SHA256WithByteArray:(IOSByteArray *)data {
  OrgBouncycastleCryptoDigestsSHA256Digest *digest = [[OrgBouncycastleCryptoDigestsSHA256Digest alloc] init];
  [digest updateWithByteArray:data withInt:0 withInt:((IOSByteArray *) nil_chk(data))->size_];
  IOSByteArray *res = [IOSByteArray newArrayWithLength:32];
  [digest doFinalWithByteArray:res withInt:0];
  return res;
}

- (IOSByteArray *)SHA512WithByteArray:(IOSByteArray *)data {
  OrgBouncycastleCryptoDigestsSHA512Digest *digest = [[OrgBouncycastleCryptoDigestsSHA512Digest alloc] init];
  [digest updateWithByteArray:data withInt:0 withInt:((IOSByteArray *) nil_chk(data))->size_];
  IOSByteArray *res = [IOSByteArray newArrayWithLength:64];
  [digest doFinalWithByteArray:res withInt:0];
  return res;
}

- (IOSByteArray *)randomBytesWithInt:(jint)length {
  IOSByteArray *res = [IOSByteArray newArrayWithLength:length];
  @synchronized(BCBouncyCastleProvider_RANDOM_) {
    [((JavaSecuritySecureRandom *) nil_chk(BCBouncyCastleProvider_RANDOM_)) nextBytesWithByteArray:res];
  }
  return res;
}

- (jint)randomIntWithInt:(jint)maxValue {
  @synchronized(BCBouncyCastleProvider_RANDOM_) {
    return [((JavaSecuritySecureRandom *) nil_chk(BCBouncyCastleProvider_RANDOM_)) nextIntWithInt:maxValue];
  }
}

- (instancetype)init {
  return [super init];
}

+ (void)initialize {
  if (self == [BCBouncyCastleProvider class]) {
    BCBouncyCastleProvider_RSA_EXPONENT_ = [[JavaMathBigInteger alloc] initWithNSString:@"3"];
    BCBouncyCastleProvider_ZERO_ = JavaMathBigInteger_valueOfWithLong_(0);
    BCBouncyCastleProvider_RANDOM_ = [[JavaSecuritySecureRandom alloc] init];
    J2OBJC_SET_INITIALIZED(BCBouncyCastleProvider)
  }
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(BCBouncyCastleProvider)
