//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/actor-ios/build/java/im/actor/model/viewmodel/UserVM.java
//

#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "im/actor/model/MainThread.h"
#include "im/actor/model/entity/Avatar.h"
#include "im/actor/model/entity/Sex.h"
#include "im/actor/model/entity/User.h"
#include "im/actor/model/mvvm/MVVMEngine.h"
#include "im/actor/model/mvvm/ModelChangedListener.h"
#include "im/actor/model/mvvm/ValueModel.h"
#include "im/actor/model/viewmodel/UserPresence.h"
#include "im/actor/model/viewmodel/UserVM.h"
#include "java/lang/Boolean.h"
#include "java/util/ArrayList.h"

__attribute__((unused)) static void ImActorModelViewmodelUserVM_notifyChange(ImActorModelViewmodelUserVM *self);

@interface ImActorModelViewmodelUserVM () {
 @public
  jint id__;
  jlong hash__;
  AMValueModel *name_;
  AMValueModel *avatar_;
  AMSexEnum *sex_;
  AMValueModel *isContact__;
  AMValueModel *presence_;
  JavaUtilArrayList *listeners_;
}

- (void)notifyChange;
@end

J2OBJC_FIELD_SETTER(ImActorModelViewmodelUserVM, name_, AMValueModel *)
J2OBJC_FIELD_SETTER(ImActorModelViewmodelUserVM, avatar_, AMValueModel *)
J2OBJC_FIELD_SETTER(ImActorModelViewmodelUserVM, sex_, AMSexEnum *)
J2OBJC_FIELD_SETTER(ImActorModelViewmodelUserVM, isContact__, AMValueModel *)
J2OBJC_FIELD_SETTER(ImActorModelViewmodelUserVM, presence_, AMValueModel *)
J2OBJC_FIELD_SETTER(ImActorModelViewmodelUserVM, listeners_, JavaUtilArrayList *)

@interface ImActorModelViewmodelUserVM_$1 () {
 @public
  ImActorModelViewmodelUserVM *this$0_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelViewmodelUserVM_$1, this$0_, ImActorModelViewmodelUserVM *)

@implementation ImActorModelViewmodelUserVM

- (instancetype)initWithAMUser:(AMUser *)user {
  if (self = [super initWithId:user]) {
    listeners_ = [[JavaUtilArrayList alloc] init];
    id__ = [((AMUser *) nil_chk(user)) getUid];
    hash__ = [user getAccessHash];
    sex_ = [user getSex];
    name_ = [[AMValueModel alloc] initWithNSString:JreStrcat("$I$", @"user.", id__, @".name") withId:[user getName]];
    avatar_ = [[AMValueModel alloc] initWithNSString:JreStrcat("$I$", @"user.", id__, @".avatar") withId:[user getAvatar]];
    isContact__ = [[AMValueModel alloc] initWithNSString:JreStrcat("$I$", @"user.", id__, @".contact") withId:JavaLangBoolean_valueOfWithBoolean_(NO)];
    presence_ = [[AMValueModel alloc] initWithNSString:JreStrcat("$I$", @"user.", id__, @".presence") withId:[[ImActorModelViewmodelUserPresence alloc] initWithImActorModelViewmodelUserPresence_StateEnum:ImActorModelViewmodelUserPresence_StateEnum_get_UNKNOWN()]];
  }
  return self;
}

- (void)updateValuesWithId:(AMUser *)rawObj {
  jboolean isChanged = NO;
  isChanged |= [((AMValueModel *) nil_chk(name_)) changeWithId:[((AMUser *) nil_chk(rawObj)) getName]];
  isChanged |= [((AMValueModel *) nil_chk(avatar_)) changeWithId:[rawObj getAvatar]];
  if (isChanged) {
    ImActorModelViewmodelUserVM_notifyChange(self);
  }
}

- (jint)getId {
  return id__;
}

- (jlong)getHash {
  return hash__;
}

- (AMValueModel *)getName {
  return name_;
}

- (AMValueModel *)getAvatar {
  return avatar_;
}

- (AMSexEnum *)getSex {
  return sex_;
}

- (AMValueModel *)isContact {
  return isContact__;
}

- (AMValueModel *)getPresence {
  return presence_;
}

- (void)subscribeWithAMModelChangedListener:(id<AMModelChangedListener>)listener {
  if ([((JavaUtilArrayList *) nil_chk(listeners_)) containsWithId:listener]) {
    return;
  }
  [listeners_ addWithId:listener];
  [((id<AMModelChangedListener>) nil_chk(listener)) onChangedWithId:self];
}

- (void)unsubscribeWithAMModelChangedListener:(id<AMModelChangedListener>)listener {
  [((JavaUtilArrayList *) nil_chk(listeners_)) removeWithId:listener];
}

- (void)notifyChange {
  ImActorModelViewmodelUserVM_notifyChange(self);
}

- (void)copyAllFieldsTo:(ImActorModelViewmodelUserVM *)other {
  [super copyAllFieldsTo:other];
  other->id__ = id__;
  other->hash__ = hash__;
  other->name_ = name_;
  other->avatar_ = avatar_;
  other->sex_ = sex_;
  other->isContact__ = isContact__;
  other->presence_ = presence_;
  other->listeners_ = listeners_;
}

@end

void ImActorModelViewmodelUserVM_notifyChange(ImActorModelViewmodelUserVM *self) {
  [((id<AMMainThread>) nil_chk(AMMVVMEngine_getMainThread())) runOnUiThread:[[ImActorModelViewmodelUserVM_$1 alloc] initWithImActorModelViewmodelUserVM:self]];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelViewmodelUserVM)

@implementation ImActorModelViewmodelUserVM_$1

- (void)run {
  {
    IOSObjectArray *a__ = [((JavaUtilArrayList *) nil_chk(this$0_->listeners_)) toArrayWithNSObjectArray:[IOSObjectArray newArrayWithLength:0 type:AMModelChangedListener_class_()]];
    id<AMModelChangedListener> const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    id<AMModelChangedListener> const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      id<AMModelChangedListener> l = *b__++;
      [((id<AMModelChangedListener>) nil_chk(l)) onChangedWithId:this$0_];
    }
  }
}

- (instancetype)initWithImActorModelViewmodelUserVM:(ImActorModelViewmodelUserVM *)outer$ {
  this$0_ = outer$;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelViewmodelUserVM_$1 *)other {
  [super copyAllFieldsTo:other];
  other->this$0_ = this$0_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelViewmodelUserVM_$1)
