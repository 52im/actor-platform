//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/actor-ios/build/java/im/actor/model/i18n/I18nEngine.java
//

#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "im/actor/model/LocaleProvider.h"
#include "im/actor/model/i18n/I18nEngine.h"
#include "java/util/Date.h"
#include "java/util/HashMap.h"

@interface ImActorModelI18nI18nEngine () {
 @public
  JavaUtilHashMap *locale_;
  IOSObjectArray *MONTHS_SHORT_;
  IOSObjectArray *MONTHS_;
}

- (NSString *)formatTwoDigitWithInt:(jint)v;
@end

J2OBJC_FIELD_SETTER(ImActorModelI18nI18nEngine, locale_, JavaUtilHashMap *)
J2OBJC_FIELD_SETTER(ImActorModelI18nI18nEngine, MONTHS_SHORT_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(ImActorModelI18nI18nEngine, MONTHS_, IOSObjectArray *)

@implementation ImActorModelI18nI18nEngine

- (instancetype)initWithAMLocaleProvider:(id<AMLocaleProvider>)provider {
  if (self = [super init]) {
    self->locale_ = [((id<AMLocaleProvider>) nil_chk(provider)) loadLocale];
    MONTHS_SHORT_ = [IOSObjectArray newArrayWithObjects:(id[]){ [((JavaUtilHashMap *) nil_chk(locale_)) getWithId:@"JanShort"], [locale_ getWithId:@"FebShort"], [locale_ getWithId:@"MarShort"], [locale_ getWithId:@"AprShort"], [locale_ getWithId:@"MayShort"], [locale_ getWithId:@"JunShort"], [locale_ getWithId:@"JulShort"], [locale_ getWithId:@"AugShort"], [locale_ getWithId:@"SepShort"], [locale_ getWithId:@"OctShort"], [locale_ getWithId:@"NovShort"], [locale_ getWithId:@"DecShort"] } count:12 type:NSString_class_()];
    MONTHS_ = [IOSObjectArray newArrayWithObjects:(id[]){ [locale_ getWithId:@"JanFull"], [locale_ getWithId:@"FebFull"], [locale_ getWithId:@"MarFull"], [locale_ getWithId:@"AprFull"], [locale_ getWithId:@"MayFull"], [locale_ getWithId:@"JunFull"], [locale_ getWithId:@"JulFull"], [locale_ getWithId:@"AugFull"], [locale_ getWithId:@"SepFull"], [locale_ getWithId:@"OctFull"], [locale_ getWithId:@"NovFull"], [locale_ getWithId:@"DecFull"] } count:12 type:NSString_class_()];
  }
  return self;
}

- (NSString *)formatTwoDigitWithInt:(jint)v {
  if (v < 0) {
    return JreStrcat("I", v);
  }
  else if (v < 10) {
    return JreStrcat("CI", '0', v);
  }
  else {
    return JreStrcat("I", v);
  }
}

- (NSString *)formatShortDateWithLong:(jlong)date {
  jlong delta = [((JavaUtilDate *) [[JavaUtilDate alloc] init]) getTime] - date;
  if (delta < 60 * 1000) {
    return [((JavaUtilHashMap *) nil_chk(locale_)) getWithId:@"TimeShortNow"];
  }
  else if (delta < 60 * 60 * 1000) {
    return [((NSString *) nil_chk([((JavaUtilHashMap *) nil_chk(locale_)) getWithId:@"TimeShortMinutes"])) replace:@"{minutes}" withSequence:JreStrcat("J", delta / 60000)];
  }
  else if (delta < 24 * 60 * 60 * 1000) {
    return [((NSString *) nil_chk([((JavaUtilHashMap *) nil_chk(locale_)) getWithId:@"TimeShortHours"])) replace:@"{hours}" withSequence:JreStrcat("J", delta / 3600000)];
  }
  else if (delta < 2 * 24 * 60 * 60 * 1000) {
    return [((NSString *) nil_chk([((JavaUtilHashMap *) nil_chk(locale_)) getWithId:@"TimeShortYesterday"])) replace:@"{hours}" withSequence:JreStrcat("J", delta / 3600000)];
  }
  else {
    JavaUtilDate *date1 = [[JavaUtilDate alloc] initWithLong:date];
    jint month = [date1 getMonth];
    jint d = [date1 getDate];
    return JreStrcat("IC$", d, ' ', [((NSString *) nil_chk(IOSObjectArray_Get(nil_chk(MONTHS_SHORT_), month))) uppercaseString]);
  }
}

- (void)copyAllFieldsTo:(ImActorModelI18nI18nEngine *)other {
  [super copyAllFieldsTo:other];
  other->locale_ = locale_;
  other->MONTHS_SHORT_ = MONTHS_SHORT_;
  other->MONTHS_ = MONTHS_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelI18nI18nEngine)
