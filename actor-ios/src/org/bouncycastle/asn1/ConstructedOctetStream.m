//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/actor-ios/build/java/org/bouncycastle/asn1/ConstructedOctetStream.java
//

#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/io/InputStream.h"
#include "org/bouncycastle/asn1/ASN1Encodable.h"
#include "org/bouncycastle/asn1/ASN1OctetStringParser.h"
#include "org/bouncycastle/asn1/ASN1StreamParser.h"
#include "org/bouncycastle/asn1/ConstructedOctetStream.h"

@interface OrgBouncycastleAsn1ConstructedOctetStream () {
 @public
  OrgBouncycastleAsn1ASN1StreamParser *_parser_;
  jboolean _first_;
  JavaIoInputStream *_currentStream_;
}
@end

J2OBJC_FIELD_SETTER(OrgBouncycastleAsn1ConstructedOctetStream, _parser_, OrgBouncycastleAsn1ASN1StreamParser *)
J2OBJC_FIELD_SETTER(OrgBouncycastleAsn1ConstructedOctetStream, _currentStream_, JavaIoInputStream *)

@implementation OrgBouncycastleAsn1ConstructedOctetStream

- (instancetype)initWithOrgBouncycastleAsn1ASN1StreamParser:(OrgBouncycastleAsn1ASN1StreamParser *)parser {
  if (self = [super init]) {
    _first_ = YES;
    _parser_ = parser;
  }
  return self;
}

- (jint)readWithByteArray:(IOSByteArray *)b
                  withInt:(jint)off
                  withInt:(jint)len {
  if (_currentStream_ == nil) {
    if (!_first_) {
      return -1;
    }
    id<OrgBouncycastleAsn1ASN1OctetStringParser> s = (id<OrgBouncycastleAsn1ASN1OctetStringParser>) check_protocol_cast([((OrgBouncycastleAsn1ASN1StreamParser *) nil_chk(_parser_)) readObject], @protocol(OrgBouncycastleAsn1ASN1OctetStringParser));
    if (s == nil) {
      return -1;
    }
    _first_ = NO;
    _currentStream_ = [((id<OrgBouncycastleAsn1ASN1OctetStringParser>) nil_chk(s)) getOctetStream];
  }
  jint totalRead = 0;
  for (; ; ) {
    jint numRead = [((JavaIoInputStream *) nil_chk(_currentStream_)) readWithByteArray:b withInt:off + totalRead withInt:len - totalRead];
    if (numRead >= 0) {
      totalRead += numRead;
      if (totalRead == len) {
        return totalRead;
      }
    }
    else {
      id<OrgBouncycastleAsn1ASN1OctetStringParser> aos = (id<OrgBouncycastleAsn1ASN1OctetStringParser>) check_protocol_cast([((OrgBouncycastleAsn1ASN1StreamParser *) nil_chk(_parser_)) readObject], @protocol(OrgBouncycastleAsn1ASN1OctetStringParser));
      if (aos == nil) {
        _currentStream_ = nil;
        return totalRead < 1 ? -1 : totalRead;
      }
      _currentStream_ = [((id<OrgBouncycastleAsn1ASN1OctetStringParser>) nil_chk(aos)) getOctetStream];
    }
  }
}

- (jint)read {
  if (_currentStream_ == nil) {
    if (!_first_) {
      return -1;
    }
    id<OrgBouncycastleAsn1ASN1OctetStringParser> s = (id<OrgBouncycastleAsn1ASN1OctetStringParser>) check_protocol_cast([((OrgBouncycastleAsn1ASN1StreamParser *) nil_chk(_parser_)) readObject], @protocol(OrgBouncycastleAsn1ASN1OctetStringParser));
    if (s == nil) {
      return -1;
    }
    _first_ = NO;
    _currentStream_ = [((id<OrgBouncycastleAsn1ASN1OctetStringParser>) nil_chk(s)) getOctetStream];
  }
  for (; ; ) {
    jint b = [((JavaIoInputStream *) nil_chk(_currentStream_)) read];
    if (b >= 0) {
      return b;
    }
    id<OrgBouncycastleAsn1ASN1OctetStringParser> s = (id<OrgBouncycastleAsn1ASN1OctetStringParser>) check_protocol_cast([((OrgBouncycastleAsn1ASN1StreamParser *) nil_chk(_parser_)) readObject], @protocol(OrgBouncycastleAsn1ASN1OctetStringParser));
    if (s == nil) {
      _currentStream_ = nil;
      return -1;
    }
    _currentStream_ = [((id<OrgBouncycastleAsn1ASN1OctetStringParser>) nil_chk(s)) getOctetStream];
  }
}

- (void)copyAllFieldsTo:(OrgBouncycastleAsn1ConstructedOctetStream *)other {
  [super copyAllFieldsTo:other];
  other->_parser_ = _parser_;
  other->_first_ = _first_;
  other->_currentStream_ = _currentStream_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgBouncycastleAsn1ConstructedOctetStream)
