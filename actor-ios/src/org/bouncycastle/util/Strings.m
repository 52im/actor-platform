//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/actor-ios/build/java/org/bouncycastle/util/Strings.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/ByteArrayOutputStream.h"
#include "java/io/IOException.h"
#include "java/io/OutputStream.h"
#include "java/lang/IllegalStateException.h"
#include "java/util/Vector.h"
#include "org/bouncycastle/util/Strings.h"

@implementation OrgBouncycastleUtilStrings

+ (NSString *)fromUTF8ByteArrayWithByteArray:(IOSByteArray *)bytes {
  return OrgBouncycastleUtilStrings_fromUTF8ByteArrayWithByteArray_(bytes);
}

+ (IOSByteArray *)toUTF8ByteArrayWithNSString:(NSString *)string {
  return OrgBouncycastleUtilStrings_toUTF8ByteArrayWithNSString_(string);
}

+ (IOSByteArray *)toUTF8ByteArrayWithCharArray:(IOSCharArray *)string {
  return OrgBouncycastleUtilStrings_toUTF8ByteArrayWithCharArray_(string);
}

+ (void)toUTF8ByteArrayWithCharArray:(IOSCharArray *)string
              withJavaIoOutputStream:(JavaIoOutputStream *)sOut {
  OrgBouncycastleUtilStrings_toUTF8ByteArrayWithCharArray_withJavaIoOutputStream_(string, sOut);
}

+ (NSString *)toUpperCaseWithNSString:(NSString *)string {
  return OrgBouncycastleUtilStrings_toUpperCaseWithNSString_(string);
}

+ (NSString *)toLowerCaseWithNSString:(NSString *)string {
  return OrgBouncycastleUtilStrings_toLowerCaseWithNSString_(string);
}

+ (IOSByteArray *)toByteArrayWithCharArray:(IOSCharArray *)chars {
  return OrgBouncycastleUtilStrings_toByteArrayWithCharArray_(chars);
}

+ (IOSByteArray *)toByteArrayWithNSString:(NSString *)string {
  return OrgBouncycastleUtilStrings_toByteArrayWithNSString_(string);
}

+ (jint)toByteArrayWithNSString:(NSString *)s
                  withByteArray:(IOSByteArray *)buf
                        withInt:(jint)off {
  return OrgBouncycastleUtilStrings_toByteArrayWithNSString_withByteArray_withInt_(s, buf, off);
}

+ (NSString *)fromByteArrayWithByteArray:(IOSByteArray *)bytes {
  return OrgBouncycastleUtilStrings_fromByteArrayWithByteArray_(bytes);
}

+ (IOSCharArray *)asCharArrayWithByteArray:(IOSByteArray *)bytes {
  return OrgBouncycastleUtilStrings_asCharArrayWithByteArray_(bytes);
}

+ (IOSObjectArray *)splitWithNSString:(NSString *)input
                             withChar:(jchar)delimiter {
  return OrgBouncycastleUtilStrings_splitWithNSString_withChar_(input, delimiter);
}

- (instancetype)init {
  return [super init];
}

@end

NSString *OrgBouncycastleUtilStrings_fromUTF8ByteArrayWithByteArray_(IOSByteArray *bytes) {
  OrgBouncycastleUtilStrings_init();
  jint i = 0;
  jint length = 0;
  while (i < ((IOSByteArray *) nil_chk(bytes))->size_) {
    length++;
    if ((IOSByteArray_Get(bytes, i) & (jint) 0xf0) == (jint) 0xf0) {
      length++;
      i += 4;
    }
    else if ((IOSByteArray_Get(bytes, i) & (jint) 0xe0) == (jint) 0xe0) {
      i += 3;
    }
    else if ((IOSByteArray_Get(bytes, i) & (jint) 0xc0) == (jint) 0xc0) {
      i += 2;
    }
    else {
      i += 1;
    }
  }
  IOSCharArray *cs = [IOSCharArray newArrayWithLength:length];
  i = 0;
  length = 0;
  while (i < bytes->size_) {
    jchar ch;
    if ((IOSByteArray_Get(bytes, i) & (jint) 0xf0) == (jint) 0xf0) {
      jint codePoint = (LShift32((IOSByteArray_Get(bytes, i) & (jint) 0x03), 18)) | (LShift32((IOSByteArray_Get(bytes, i + 1) & (jint) 0x3F), 12)) | (LShift32((IOSByteArray_Get(bytes, i + 2) & (jint) 0x3F), 6)) | (IOSByteArray_Get(bytes, i + 3) & (jint) 0x3F);
      jint U = codePoint - (jint) 0x10000;
      jchar W1 = (jchar) ((jint) 0xD800 | (RShift32(U, 10)));
      jchar W2 = (jchar) ((jint) 0xDC00 | (U & (jint) 0x3FF));
      *IOSCharArray_GetRef(cs, length++) = W1;
      ch = W2;
      i += 4;
    }
    else if ((IOSByteArray_Get(bytes, i) & (jint) 0xe0) == (jint) 0xe0) {
      ch = (jchar) ((LShift32((IOSByteArray_Get(bytes, i) & (jint) 0x0f), 12)) | (LShift32((IOSByteArray_Get(bytes, i + 1) & (jint) 0x3f), 6)) | (IOSByteArray_Get(bytes, i + 2) & (jint) 0x3f));
      i += 3;
    }
    else if ((IOSByteArray_Get(bytes, i) & (jint) 0xd0) == (jint) 0xd0) {
      ch = (jchar) ((LShift32((IOSByteArray_Get(bytes, i) & (jint) 0x1f), 6)) | (IOSByteArray_Get(bytes, i + 1) & (jint) 0x3f));
      i += 2;
    }
    else if ((IOSByteArray_Get(bytes, i) & (jint) 0xc0) == (jint) 0xc0) {
      ch = (jchar) ((LShift32((IOSByteArray_Get(bytes, i) & (jint) 0x1f), 6)) | (IOSByteArray_Get(bytes, i + 1) & (jint) 0x3f));
      i += 2;
    }
    else {
      ch = (jchar) (IOSByteArray_Get(bytes, i) & (jint) 0xff);
      i += 1;
    }
    *IOSCharArray_GetRef(cs, length++) = ch;
  }
  return [NSString stringWithCharacters:cs];
}

IOSByteArray *OrgBouncycastleUtilStrings_toUTF8ByteArrayWithNSString_(NSString *string) {
  OrgBouncycastleUtilStrings_init();
  return OrgBouncycastleUtilStrings_toUTF8ByteArrayWithCharArray_([((NSString *) nil_chk(string)) toCharArray]);
}

IOSByteArray *OrgBouncycastleUtilStrings_toUTF8ByteArrayWithCharArray_(IOSCharArray *string) {
  OrgBouncycastleUtilStrings_init();
  JavaIoByteArrayOutputStream *bOut = [[JavaIoByteArrayOutputStream alloc] init];
  @try {
    OrgBouncycastleUtilStrings_toUTF8ByteArrayWithCharArray_withJavaIoOutputStream_(string, bOut);
  }
  @catch (JavaIoIOException *e) {
    @throw [[JavaLangIllegalStateException alloc] initWithNSString:@"cannot encode string to byte array!"];
  }
  return [bOut toByteArray];
}

void OrgBouncycastleUtilStrings_toUTF8ByteArrayWithCharArray_withJavaIoOutputStream_(IOSCharArray *string, JavaIoOutputStream *sOut) {
  OrgBouncycastleUtilStrings_init();
  IOSCharArray *c = string;
  jint i = 0;
  while (i < ((IOSCharArray *) nil_chk(c))->size_) {
    jchar ch = IOSCharArray_Get(c, i);
    if (ch < (jint) 0x0080) {
      [((JavaIoOutputStream *) nil_chk(sOut)) writeWithInt:ch];
    }
    else if (ch < (jint) 0x0800) {
      [((JavaIoOutputStream *) nil_chk(sOut)) writeWithInt:(jint) 0xc0 | (RShift32(ch, 6))];
      [sOut writeWithInt:(jint) 0x80 | (ch & (jint) 0x3f)];
    }
    else if (ch >= (jint) 0xD800 && ch <= (jint) 0xDFFF) {
      if (i + 1 >= c->size_) {
        @throw [[JavaLangIllegalStateException alloc] initWithNSString:@"invalid UTF-16 codepoint"];
      }
      jchar W1 = ch;
      ch = IOSCharArray_Get(c, ++i);
      jchar W2 = ch;
      if (W1 > (jint) 0xDBFF) {
        @throw [[JavaLangIllegalStateException alloc] initWithNSString:@"invalid UTF-16 codepoint"];
      }
      jint codePoint = ((LShift32((W1 & (jint) 0x03FF), 10)) | (W2 & (jint) 0x03FF)) + (jint) 0x10000;
      [((JavaIoOutputStream *) nil_chk(sOut)) writeWithInt:(jint) 0xf0 | (RShift32(codePoint, 18))];
      [sOut writeWithInt:(jint) 0x80 | ((RShift32(codePoint, 12)) & (jint) 0x3F)];
      [sOut writeWithInt:(jint) 0x80 | ((RShift32(codePoint, 6)) & (jint) 0x3F)];
      [sOut writeWithInt:(jint) 0x80 | (codePoint & (jint) 0x3F)];
    }
    else {
      [((JavaIoOutputStream *) nil_chk(sOut)) writeWithInt:(jint) 0xe0 | (RShift32(ch, 12))];
      [sOut writeWithInt:(jint) 0x80 | ((RShift32(ch, 6)) & (jint) 0x3F)];
      [sOut writeWithInt:(jint) 0x80 | (ch & (jint) 0x3F)];
    }
    i++;
  }
}

NSString *OrgBouncycastleUtilStrings_toUpperCaseWithNSString_(NSString *string) {
  OrgBouncycastleUtilStrings_init();
  jboolean changed = NO;
  IOSCharArray *chars = [((NSString *) nil_chk(string)) toCharArray];
  for (jint i = 0; i != ((IOSCharArray *) nil_chk(chars))->size_; i++) {
    jchar ch = IOSCharArray_Get(chars, i);
    if ('a' <= ch && 'z' >= ch) {
      changed = YES;
      *IOSCharArray_GetRef(chars, i) = (jchar) (ch - 'a' + 'A');
    }
  }
  if (changed) {
    return [NSString stringWithCharacters:chars];
  }
  return string;
}

NSString *OrgBouncycastleUtilStrings_toLowerCaseWithNSString_(NSString *string) {
  OrgBouncycastleUtilStrings_init();
  jboolean changed = NO;
  IOSCharArray *chars = [((NSString *) nil_chk(string)) toCharArray];
  for (jint i = 0; i != ((IOSCharArray *) nil_chk(chars))->size_; i++) {
    jchar ch = IOSCharArray_Get(chars, i);
    if ('A' <= ch && 'Z' >= ch) {
      changed = YES;
      *IOSCharArray_GetRef(chars, i) = (jchar) (ch - 'A' + 'a');
    }
  }
  if (changed) {
    return [NSString stringWithCharacters:chars];
  }
  return string;
}

IOSByteArray *OrgBouncycastleUtilStrings_toByteArrayWithCharArray_(IOSCharArray *chars) {
  OrgBouncycastleUtilStrings_init();
  IOSByteArray *bytes = [IOSByteArray newArrayWithLength:((IOSCharArray *) nil_chk(chars))->size_];
  for (jint i = 0; i != bytes->size_; i++) {
    *IOSByteArray_GetRef(bytes, i) = (jbyte) IOSCharArray_Get(chars, i);
  }
  return bytes;
}

IOSByteArray *OrgBouncycastleUtilStrings_toByteArrayWithNSString_(NSString *string) {
  OrgBouncycastleUtilStrings_init();
  IOSByteArray *bytes = [IOSByteArray newArrayWithLength:((jint) [((NSString *) nil_chk(string)) length])];
  for (jint i = 0; i != bytes->size_; i++) {
    jchar ch = [string charAtWithInt:i];
    *IOSByteArray_GetRef(bytes, i) = (jbyte) ch;
  }
  return bytes;
}

jint OrgBouncycastleUtilStrings_toByteArrayWithNSString_withByteArray_withInt_(NSString *s, IOSByteArray *buf, jint off) {
  OrgBouncycastleUtilStrings_init();
  jint count = ((jint) [((NSString *) nil_chk(s)) length]);
  for (jint i = 0; i < count; ++i) {
    jchar c = [s charAtWithInt:i];
    *IOSByteArray_GetRef(nil_chk(buf), off + i) = (jbyte) c;
  }
  return count;
}

NSString *OrgBouncycastleUtilStrings_fromByteArrayWithByteArray_(IOSByteArray *bytes) {
  OrgBouncycastleUtilStrings_init();
  return [NSString stringWithCharacters:OrgBouncycastleUtilStrings_asCharArrayWithByteArray_(bytes)];
}

IOSCharArray *OrgBouncycastleUtilStrings_asCharArrayWithByteArray_(IOSByteArray *bytes) {
  OrgBouncycastleUtilStrings_init();
  IOSCharArray *chars = [IOSCharArray newArrayWithLength:((IOSByteArray *) nil_chk(bytes))->size_];
  for (jint i = 0; i != chars->size_; i++) {
    *IOSCharArray_GetRef(chars, i) = (jchar) (IOSByteArray_Get(bytes, i) & (jint) 0xff);
  }
  return chars;
}

IOSObjectArray *OrgBouncycastleUtilStrings_splitWithNSString_withChar_(NSString *input, jchar delimiter) {
  OrgBouncycastleUtilStrings_init();
  JavaUtilVector *v = [[JavaUtilVector alloc] init];
  jboolean moreTokens = YES;
  NSString *subString;
  while (moreTokens) {
    jint tokenLocation = [((NSString *) nil_chk(input)) indexOf:delimiter];
    if (tokenLocation > 0) {
      subString = [input substring:0 endIndex:tokenLocation];
      [v addElementWithId:subString];
      input = [input substring:tokenLocation + 1];
    }
    else {
      moreTokens = NO;
      [v addElementWithId:input];
    }
  }
  IOSObjectArray *res = [IOSObjectArray newArrayWithLength:[v size] type:NSString_class_()];
  for (jint i = 0; i != res->size_; i++) {
    IOSObjectArray_Set(res, i, (NSString *) check_class_cast([v elementAtWithInt:i], [NSString class]));
  }
  return res;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgBouncycastleUtilStrings)
