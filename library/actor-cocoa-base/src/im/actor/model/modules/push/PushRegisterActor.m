//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/library/actor-cocoa-base/build/java/im/actor/model/modules/push/PushRegisterActor.java
//

#line 1 "/Users/ex3ndr/Develop/actor-model/library/actor-cocoa-base/build/java/im/actor/model/modules/push/PushRegisterActor.java"

#include "J2ObjC_source.h"
#include "im/actor/model/api/rpc/RequestRegisterApplePush.h"
#include "im/actor/model/api/rpc/RequestRegisterGooglePush.h"
#include "im/actor/model/api/rpc/ResponseVoid.h"
#include "im/actor/model/droidkit/actors/Actor.h"
#include "im/actor/model/droidkit/engine/PreferencesStorage.h"
#include "im/actor/model/modules/Modules.h"
#include "im/actor/model/modules/push/PushRegisterActor.h"
#include "im/actor/model/modules/utils/ModuleActor.h"
#include "im/actor/model/network/RpcException.h"

__attribute__((unused)) static void ImActorModelModulesPushPushRegisterActor_registerGooglePushWithLong_withNSString_(ImActorModelModulesPushPushRegisterActor *self, jlong projectId, NSString *token);
__attribute__((unused)) static void ImActorModelModulesPushPushRegisterActor_registerApplePushWithInt_withNSString_(ImActorModelModulesPushPushRegisterActor *self, jint apnsId, NSString *token);

@interface ImActorModelModulesPushPushRegisterActor ()

- (void)registerGooglePushWithLong:(jlong)projectId
                      withNSString:(NSString *)token;

- (void)registerApplePushWithInt:(jint)apnsId
                    withNSString:(NSString *)token;
@end

@interface ImActorModelModulesPushPushRegisterActor_RegisterGooglePush () {
 @public
  jlong projectId_;
  NSString *token_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesPushPushRegisterActor_RegisterGooglePush, token_, NSString *)

@interface ImActorModelModulesPushPushRegisterActor_RegisterApplePush () {
 @public
  jint apnsKey_;
  NSString *token_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesPushPushRegisterActor_RegisterApplePush, token_, NSString *)

@interface ImActorModelModulesPushPushRegisterActor_$1 () {
 @public
  ImActorModelModulesPushPushRegisterActor *this$0_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesPushPushRegisterActor_$1, this$0_, ImActorModelModulesPushPushRegisterActor *)

@interface ImActorModelModulesPushPushRegisterActor_$2 () {
 @public
  ImActorModelModulesPushPushRegisterActor *this$0_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesPushPushRegisterActor_$2, this$0_, ImActorModelModulesPushPushRegisterActor *)


#line 14
@implementation ImActorModelModulesPushPushRegisterActor


#line 15
- (instancetype)initWithImActorModelModulesModules:(ImActorModelModulesModules *)modules {
  return
#line 16
  [super initWithImActorModelModulesModules:modules];
}


#line 20
- (void)preStart {
  if ([((id<DKPreferencesStorage>) nil_chk([self preferences])) getBool:@"push.google" withDefault:NO]) {
    if (![((id<DKPreferencesStorage>) nil_chk([self preferences])) getBool:@"push.google.registered" withDefault:NO]) {
      jlong projectId = [((id<DKPreferencesStorage>) nil_chk([self preferences])) getLong:@"push.google.id" withDefault:0];
      NSString *token = [((id<DKPreferencesStorage>) nil_chk([self preferences])) getString:@"push.google.token"];
      ImActorModelModulesPushPushRegisterActor_registerGooglePushWithLong_withNSString_(self, projectId, token);
    }
  }
  if ([((id<DKPreferencesStorage>) nil_chk([self preferences])) getBool:@"push.apple" withDefault:NO]) {
    if (![((id<DKPreferencesStorage>) nil_chk([self preferences])) getBool:@"push.apple.registered" withDefault:NO]) {
      jint apnsId = [((id<DKPreferencesStorage>) nil_chk([self preferences])) getInt:@"push.apple.id" withDefault:0];
      NSString *token = [((id<DKPreferencesStorage>) nil_chk([self preferences])) getString:@"push.apple.token"];
      ImActorModelModulesPushPushRegisterActor_registerApplePushWithInt_withNSString_(self, apnsId, token);
    }
  }
}

- (void)registerGooglePushWithLong:(jlong)projectId
                      withNSString:(NSString *)token {
  ImActorModelModulesPushPushRegisterActor_registerGooglePushWithLong_withNSString_(self, projectId, token);
}


#line 56
- (void)registerApplePushWithInt:(jint)apnsId
                    withNSString:(NSString *)token {
  ImActorModelModulesPushPushRegisterActor_registerApplePushWithInt_withNSString_(self, apnsId, token);
}


#line 76
- (void)onReceiveWithId:(id)message {
  
#line 77
  if ([message isKindOfClass:[ImActorModelModulesPushPushRegisterActor_RegisterGooglePush class]]) {
    ImActorModelModulesPushPushRegisterActor_RegisterGooglePush *registerGooglePush = (ImActorModelModulesPushPushRegisterActor_RegisterGooglePush *) check_class_cast(message, [ImActorModelModulesPushPushRegisterActor_RegisterGooglePush class]);
    ImActorModelModulesPushPushRegisterActor_registerGooglePushWithLong_withNSString_(self, [((ImActorModelModulesPushPushRegisterActor_RegisterGooglePush *) nil_chk(registerGooglePush)) getProjectId],
#line 80
    [registerGooglePush getToken]);
  }
  else
#line 81
  if ([message isKindOfClass:[ImActorModelModulesPushPushRegisterActor_RegisterApplePush class]]) {
    ImActorModelModulesPushPushRegisterActor_RegisterApplePush *applePush = (ImActorModelModulesPushPushRegisterActor_RegisterApplePush *) check_class_cast(message, [ImActorModelModulesPushPushRegisterActor_RegisterApplePush class]);
    ImActorModelModulesPushPushRegisterActor_registerApplePushWithInt_withNSString_(self, [((ImActorModelModulesPushPushRegisterActor_RegisterApplePush *) nil_chk(applePush)) getApnsKey], [applePush getToken]);
  }
  else {
    
#line 85
    [self dropWithId:message];
  }
}

@end

void ImActorModelModulesPushPushRegisterActor_registerGooglePushWithLong_withNSString_(ImActorModelModulesPushPushRegisterActor *self, jlong projectId, NSString *token) {
  
#line 38
  [((id<DKPreferencesStorage>) nil_chk([self preferences])) putBool:@"push.google" withValue:YES];
  [((id<DKPreferencesStorage>) nil_chk([self preferences])) putBool:@"push.google.registered" withValue:NO];
  [((id<DKPreferencesStorage>) nil_chk([self preferences])) putLong:@"push.google.id" withValue:projectId];
  [((id<DKPreferencesStorage>) nil_chk([self preferences])) putString:@"push.google.token" withValue:token];
  
#line 43
  [self requestWithImActorModelNetworkParserRequest:[[ImActorModelApiRpcRequestRegisterGooglePush alloc] initWithLong:projectId withNSString:token] withAMRpcCallback:[[ImActorModelModulesPushPushRegisterActor_$1 alloc] initWithImActorModelModulesPushPushRegisterActor:self]];
}

void ImActorModelModulesPushPushRegisterActor_registerApplePushWithInt_withNSString_(ImActorModelModulesPushPushRegisterActor *self, jint apnsId, NSString *token) {
  
#line 57
  [((id<DKPreferencesStorage>) nil_chk([self preferences])) putBool:@"push.apple" withValue:YES];
  [((id<DKPreferencesStorage>) nil_chk([self preferences])) putBool:@"push.apple.registered" withValue:NO];
  [((id<DKPreferencesStorage>) nil_chk([self preferences])) putInt:@"push.apple.id" withValue:apnsId];
  [((id<DKPreferencesStorage>) nil_chk([self preferences])) putString:@"push.apple.token" withValue:token];
  
#line 62
  [self requestWithImActorModelNetworkParserRequest:[[ImActorModelApiRpcRequestRegisterApplePush alloc] initWithInt:apnsId withNSString:token] withAMRpcCallback:[[ImActorModelModulesPushPushRegisterActor_$2 alloc] initWithImActorModelModulesPushPushRegisterActor:self]];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesPushPushRegisterActor)


#line 89
@implementation ImActorModelModulesPushPushRegisterActor_RegisterGooglePush


#line 93
- (instancetype)initWithLong:(jlong)projectId
                withNSString:(NSString *)token {
  if (self = [super init]) {
    
#line 94
    self->projectId_ = projectId;
    
#line 95
    self->token_ = token;
  }
  return self;
}


#line 98
- (jlong)getProjectId {
  
#line 99
  return projectId_;
}


#line 102
- (NSString *)getToken {
  
#line 103
  return token_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesPushPushRegisterActor_RegisterGooglePush *)other {
  [super copyAllFieldsTo:other];
  other->projectId_ = projectId_;
  other->token_ = token_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesPushPushRegisterActor_RegisterGooglePush)


#line 107
@implementation ImActorModelModulesPushPushRegisterActor_RegisterApplePush


#line 111
- (instancetype)initWithInt:(jint)apnsKey
               withNSString:(NSString *)token {
  if (self = [super init]) {
    
#line 112
    self->apnsKey_ = apnsKey;
    
#line 113
    self->token_ = token;
  }
  return self;
}


#line 116
- (jint)getApnsKey {
  
#line 117
  return apnsKey_;
}


#line 120
- (NSString *)getToken {
  
#line 121
  return token_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesPushPushRegisterActor_RegisterApplePush *)other {
  [super copyAllFieldsTo:other];
  other->apnsKey_ = apnsKey_;
  other->token_ = token_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesPushPushRegisterActor_RegisterApplePush)

@implementation ImActorModelModulesPushPushRegisterActor_$1


#line 45
- (void)onResultWithImActorModelNetworkParserResponse:(ImActorModelApiRpcResponseVoid *)response {
  
#line 46
  [((id<DKPreferencesStorage>) nil_chk([this$0_ preferences])) putBool:@"push.google.registered" withValue:YES];
}


#line 50
- (void)onErrorWithAMRpcException:(AMRpcException *)e {
}

- (instancetype)initWithImActorModelModulesPushPushRegisterActor:(ImActorModelModulesPushPushRegisterActor *)outer$ {
  this$0_ = outer$;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesPushPushRegisterActor_$1 *)other {
  [super copyAllFieldsTo:other];
  other->this$0_ = this$0_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesPushPushRegisterActor_$1)

@implementation ImActorModelModulesPushPushRegisterActor_$2


#line 64
- (void)onResultWithImActorModelNetworkParserResponse:(ImActorModelApiRpcResponseVoid *)response {
  
#line 65
  [((id<DKPreferencesStorage>) nil_chk([this$0_ preferences])) putBool:@"push.apple.registered" withValue:YES];
}


#line 69
- (void)onErrorWithAMRpcException:(AMRpcException *)e {
}

- (instancetype)initWithImActorModelModulesPushPushRegisterActor:(ImActorModelModulesPushPushRegisterActor *)outer$ {
  this$0_ = outer$;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesPushPushRegisterActor_$2 *)other {
  [super copyAllFieldsTo:other];
  other->this$0_ = this$0_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesPushPushRegisterActor_$2)
