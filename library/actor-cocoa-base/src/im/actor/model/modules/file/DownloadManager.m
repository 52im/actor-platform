//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/library/actor-cocoa-base/build/java/im/actor/model/modules/file/DownloadManager.java
//

#line 1 "/Users/ex3ndr/Develop/actor-model/library/actor-cocoa-base/build/java/im/actor/model/modules/file/DownloadManager.java"

#include "IOSClass.h"
#include "J2ObjC_source.h"
#include "im/actor/model/Configuration.h"
#include "im/actor/model/FileSystemProvider.h"
#include "im/actor/model/droidkit/actors/Actor.h"
#include "im/actor/model/droidkit/actors/ActorRef.h"
#include "im/actor/model/droidkit/actors/ActorSystem.h"
#include "im/actor/model/droidkit/actors/Environment.h"
#include "im/actor/model/droidkit/actors/Props.h"
#include "im/actor/model/droidkit/actors/messages/PoisonPill.h"
#include "im/actor/model/droidkit/engine/KeyValueEngine.h"
#include "im/actor/model/entity/FileReference.h"
#include "im/actor/model/files/FileSystemReference.h"
#include "im/actor/model/log/Log.h"
#include "im/actor/model/modules/Files.h"
#include "im/actor/model/modules/Modules.h"
#include "im/actor/model/modules/file/DownloadManager.h"
#include "im/actor/model/modules/file/DownloadTask.h"
#include "im/actor/model/modules/file/entity/Downloaded.h"
#include "im/actor/model/modules/utils/ModuleActor.h"
#include "im/actor/model/modules/utils/RandomUtils.h"
#include "im/actor/model/viewmodel/FileCallback.h"
#include "java/util/ArrayList.h"

__attribute__((unused)) static void ImActorModelModulesFileDownloadManager_checkQueue(ImActorModelModulesFileDownloadManager *self);
__attribute__((unused)) static ImActorModelModulesFileDownloadManager_QueueItem *ImActorModelModulesFileDownloadManager_findItemWithLong_(ImActorModelModulesFileDownloadManager *self, jlong id_);
__attribute__((unused)) static void ImActorModelModulesFileDownloadManager_promoteWithLong_(ImActorModelModulesFileDownloadManager *self, jlong id_);

@interface ImActorModelModulesFileDownloadManager () {
 @public
  jboolean LOG_;
  JavaUtilArrayList *queue_;
  id<DKKeyValueEngine> downloaded_;
}

- (void)checkQueue;

- (ImActorModelModulesFileDownloadManager_QueueItem *)findItemWithLong:(jlong)id_;

- (void)promoteWithLong:(jlong)id_;
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager, queue_, JavaUtilArrayList *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager, downloaded_, id<DKKeyValueEngine>)

@interface ImActorModelModulesFileDownloadManager_QueueItem () {
 @public
  AMFileReference *fileReference_;
  jboolean isStopped_;
  JavaUtilArrayList *callbacks_;
  jboolean isStarted_;
  jfloat progress_;
  DKActorRef *taskRef_;
}
- (instancetype)initWithImActorModelModulesFileDownloadManager:(ImActorModelModulesFileDownloadManager *)outer$
                                           withAMFileReference:(AMFileReference *)fileReference;
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_QueueItem, fileReference_, AMFileReference *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_QueueItem, callbacks_, JavaUtilArrayList *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_QueueItem, taskRef_, DKActorRef *)

@interface ImActorModelModulesFileDownloadManager_RequestState () {
 @public
  jlong fileId_;
  id<AMFileCallback> callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_RequestState, callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_BindDownload () {
 @public
  AMFileReference *fileReference_;
  jboolean isAutostart__;
  id<AMFileCallback> callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_BindDownload, fileReference_, AMFileReference *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_BindDownload, callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_StartDownload () {
 @public
  AMFileReference *fileReference_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_StartDownload, fileReference_, AMFileReference *)

@interface ImActorModelModulesFileDownloadManager_CancelDownload () {
 @public
  jlong fileId_;
}
@end

@interface ImActorModelModulesFileDownloadManager_UnbindDownload () {
 @public
  jlong fileId_;
  jboolean isAutocancel__;
  id<AMFileCallback> callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_UnbindDownload, callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_OnDownloadProgress () {
 @public
  jlong fileId_;
  jfloat progress_;
}
@end

@interface ImActorModelModulesFileDownloadManager_OnDownloaded () {
 @public
  jlong fileId_;
  id<AMFileSystemReference> reference_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_OnDownloaded, reference_, id<AMFileSystemReference>)

@interface ImActorModelModulesFileDownloadManager_OnDownloadedError () {
 @public
  jlong fileId_;
}
@end

@interface ImActorModelModulesFileDownloadManager_$1 () {
 @public
  id<AMFileCallback> val$callback_;
  id<AMFileSystemReference> val$fileSystemReference_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$1, val$callback_, id<AMFileCallback>)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$1, val$fileSystemReference_, id<AMFileSystemReference>)

@interface ImActorModelModulesFileDownloadManager_$2 () {
 @public
  id<AMFileCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$2, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$3 () {
 @public
  id<AMFileCallback> val$callback_;
  jfloat val$progress_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$3, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$4 () {
 @public
  id<AMFileCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$4, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$5 () {
 @public
  id<AMFileCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$5, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$6 () {
 @public
  id<AMFileCallback> val$callback_;
  id<AMFileSystemReference> val$fileSystemReference_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$6, val$callback_, id<AMFileCallback>)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$6, val$fileSystemReference_, id<AMFileSystemReference>)

@interface ImActorModelModulesFileDownloadManager_$7 () {
 @public
  id<AMFileCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$7, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$8 () {
 @public
  id<AMFileCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$8, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$9 () {
 @public
  id<AMFileCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$9, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$10 () {
 @public
  id<AMFileCallback> val$callback_;
  jfloat val$progress_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$10, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$11 () {
 @public
  id<AMFileCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$11, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$12 () {
 @public
  id<AMFileCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$12, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$13 () {
 @public
  id<AMFileCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$13, val$callback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$14 () {
 @public
  id<AMFileCallback> val$c_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$14, val$c_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$15 () {
 @public
  ImActorModelModulesFileDownloadManager *this$0_;
  ImActorModelModulesFileDownloadManager_QueueItem *val$finalPendingQueue_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$15, this$0_, ImActorModelModulesFileDownloadManager *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$15, val$finalPendingQueue_, ImActorModelModulesFileDownloadManager_QueueItem *)

@interface ImActorModelModulesFileDownloadManager_$16 () {
 @public
  id<AMFileCallback> val$fileCallback_;
  jfloat val$progress_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$16, val$fileCallback_, id<AMFileCallback>)

@interface ImActorModelModulesFileDownloadManager_$17 () {
 @public
  id<AMFileCallback> val$fileCallback_;
  id<AMFileSystemReference> val$reference_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$17, val$fileCallback_, id<AMFileCallback>)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$17, val$reference_, id<AMFileSystemReference>)

@interface ImActorModelModulesFileDownloadManager_$18 () {
 @public
  id<AMFileCallback> val$fileCallback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileDownloadManager_$18, val$fileCallback_, id<AMFileCallback>)


#line 24
@implementation ImActorModelModulesFileDownloadManager

NSString * ImActorModelModulesFileDownloadManager_TAG_ = @"DownloadManager";


#line 35
- (instancetype)initWithImActorModelModulesModules:(ImActorModelModulesModules *)messenger {
  if (self =
#line 36
  [super initWithImActorModelModulesModules:messenger]) {
    queue_ =
#line 31
    [[JavaUtilArrayList alloc] init];
  }
  return self;
}


#line 40
- (void)preStart {
  
#line 41
  [super preStart];
  downloaded_ = [((ImActorModelModulesFiles *) nil_chk([((ImActorModelModulesModules *) nil_chk([self modules])) getFilesModule])) getDownloadedEngine];
  LOG_ = [((AMConfiguration *) nil_chk([self config])) isEnableFilesLogging];
}

- (void)requestStateWithLong:(jlong)fileId
          withAMFileCallback:(id<AMFileCallback>)callback {
  
#line 49
  if (LOG_) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$J", @"Requesting state file #", fileId));
  }
  
#line 53
  ImActorModelModulesFileEntityDownloaded *downloaded1 = [((id<DKKeyValueEngine>) nil_chk(downloaded_)) getValueWithLong:fileId];
  if (downloaded1 != nil) {
    id<AMFileSystemProvider> provider = [((AMConfiguration *) nil_chk([((ImActorModelModulesModules *) nil_chk([self modules])) getConfiguration])) getFileSystemProvider];
    id<AMFileSystemReference> reference = [((id<AMFileSystemProvider>) nil_chk(provider)) fileFromDescriptor:[downloaded1 getDescriptor]];
    jboolean isExist = [((id<AMFileSystemReference>) nil_chk(reference)) isExist];
    jint fileSize = [reference getSize];
    if (isExist && fileSize == [downloaded1 getFileSize]) {
      if (LOG_) {
        AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Downloaded");
      }
      id<AMFileSystemReference> fileSystemReference = [((id<AMFileSystemProvider>) nil_chk([((AMConfiguration *) nil_chk([((ImActorModelModulesModules *) nil_chk([self modules])) getConfiguration])) getFileSystemProvider])) fileFromDescriptor:
#line 64
      [downloaded1 getDescriptor]];
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$1 alloc] initWithAMFileCallback:callback withAMFileSystemReference:fileSystemReference]);
      
#line 71
      return;
    }
    else {
      
#line 73
      if (LOG_) {
        AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- File is corrupted");
        if (!isExist) {
          AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- File not found");
        }
        if (fileSize != [downloaded1 getFileSize]) {
          AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$I$I", @"- Incorrect file size. Expected: ", [downloaded1 getFileSize], @", got: ", fileSize));
        }
      }
      [downloaded_ removeItemWithLong:[downloaded1 getFileId]];
    }
  }
  
#line 86
  ImActorModelModulesFileDownloadManager_QueueItem *queueItem = ImActorModelModulesFileDownloadManager_findItemWithLong_(self, fileId);
  if (queueItem == nil) {
    DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$2 alloc] initWithAMFileCallback:callback]);
  }
  else {
    
#line 96
    if (queueItem->isStarted_) {
      jfloat progress = queueItem->progress_;
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$3 alloc] initWithAMFileCallback:callback withFloat:progress]);
    }
    else
#line 105
    if (queueItem->isStopped_) {
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$4 alloc] initWithAMFileCallback:callback]);
    }
    else {
      
#line 113
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$5 alloc] initWithAMFileCallback:callback]);
    }
  }
}


#line 123
- (void)bindDownloadWithAMFileReference:(AMFileReference *)fileReference
                            withBoolean:(jboolean)autoStart
                     withAMFileCallback:(id<AMFileCallback>)callback {
  
#line 124
  if (LOG_) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$J", @"Binding file #", [((AMFileReference *) nil_chk(fileReference)) getFileId]));
  }
  ImActorModelModulesFileEntityDownloaded *downloaded1 = [((id<DKKeyValueEngine>) nil_chk(downloaded_)) getValueWithLong:[((AMFileReference *) nil_chk(fileReference)) getFileId]];
  if (downloaded1 != nil) {
    id<AMFileSystemProvider> provider = [((AMConfiguration *) nil_chk([((ImActorModelModulesModules *) nil_chk([self modules])) getConfiguration])) getFileSystemProvider];
    id<AMFileSystemReference> reference = [((id<AMFileSystemProvider>) nil_chk(provider)) fileFromDescriptor:[downloaded1 getDescriptor]];
    jboolean isExist = [((id<AMFileSystemReference>) nil_chk(reference)) isExist];
    jint fileSize = [reference getSize];
    if (isExist && fileSize == [downloaded1 getFileSize]) {
      if (LOG_) {
        AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Downloaded");
      }
      id<AMFileSystemReference> fileSystemReference = [((id<AMFileSystemProvider>) nil_chk([((AMConfiguration *) nil_chk([((ImActorModelModulesModules *) nil_chk([self modules])) getConfiguration])) getFileSystemProvider])) fileFromDescriptor:
#line 138
      [downloaded1 getDescriptor]];
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$6 alloc] initWithAMFileCallback:callback withAMFileSystemReference:fileSystemReference]);
      
#line 145
      return;
    }
    else {
      
#line 147
      if (LOG_) {
        AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- File is corrupted");
        if (!isExist) {
          AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- File not found");
        }
        if (fileSize != [downloaded1 getFileSize]) {
          AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$I$I", @"- Incorrect file size. Expected: ", [downloaded1 getFileSize], @", got: ", fileSize));
        }
      }
      [downloaded_ removeItemWithLong:[downloaded1 getFileId]];
    }
  }
  
#line 160
  ImActorModelModulesFileDownloadManager_QueueItem *queueItem = ImActorModelModulesFileDownloadManager_findItemWithLong_(self, [fileReference getFileId]);
  if (queueItem == nil) {
    if (LOG_) {
      AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Adding to queue");
    }
    
#line 166
    queueItem = [[ImActorModelModulesFileDownloadManager_QueueItem alloc] initWithImActorModelModulesFileDownloadManager:self withAMFileReference:fileReference];
    [((JavaUtilArrayList *) nil_chk(queueItem->callbacks_)) addWithId:callback];
    
#line 169
    if (autoStart) {
      queueItem->isStopped_ = NO;
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$7 alloc] initWithAMFileCallback:callback]);
    }
    else {
      
#line 178
      queueItem->isStopped_ = YES;
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$8 alloc] initWithAMFileCallback:callback]);
    }
    
#line 187
    [((JavaUtilArrayList *) nil_chk(queue_)) addWithInt:0 withId:queueItem];
  }
  else {
    
#line 189
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Promoting in queue");
    
#line 191
    ImActorModelModulesFileDownloadManager_promoteWithLong_(self, [fileReference getFileId]);
    
#line 193
    if (![((JavaUtilArrayList *) nil_chk(queueItem->callbacks_)) containsWithId:callback]) {
      [queueItem->callbacks_ addWithId:callback];
    }
    
#line 197
    if (queueItem->isStopped_) {
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$9 alloc] initWithAMFileCallback:callback]);
    }
    else {
      
#line 205
      if (queueItem->isStarted_) {
        jfloat progress = queueItem->progress_;
        DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$10 alloc] initWithAMFileCallback:callback withFloat:progress]);
      }
      else {
        
#line 214
        DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$11 alloc] initWithAMFileCallback:callback]);
      }
    }
  }
  
#line 224
  ImActorModelModulesFileDownloadManager_checkQueue(self);
}

- (void)startDownloadWithAMFileReference:(AMFileReference *)fileReference {
  
#line 228
  if (LOG_) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$J", @"Starting download #", [((AMFileReference *) nil_chk(fileReference)) getFileId]));
  }
  ImActorModelModulesFileDownloadManager_QueueItem *queueItem = ImActorModelModulesFileDownloadManager_findItemWithLong_(self, [((AMFileReference *) nil_chk(fileReference)) getFileId]);
  if (queueItem == nil) {
    if (LOG_) {
      AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Adding to queue");
    }
    queueItem = [[ImActorModelModulesFileDownloadManager_QueueItem alloc] initWithImActorModelModulesFileDownloadManager:self withAMFileReference:fileReference];
    queueItem->isStopped_ = NO;
    [((JavaUtilArrayList *) nil_chk(queue_)) addWithInt:0 withId:queueItem];
  }
  else {
    
#line 240
    if (LOG_) {
      AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Promoting in queue");
    }
    if (queueItem->isStopped_) {
      queueItem->isStopped_ = NO;
      for (id<AMFileCallback> __strong callback in nil_chk(queueItem->callbacks_)) {
        DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$12 alloc] initWithAMFileCallback:callback]);
      }
    }
    
#line 254
    ImActorModelModulesFileDownloadManager_promoteWithLong_(self, [fileReference getFileId]);
  }
  
#line 257
  ImActorModelModulesFileDownloadManager_checkQueue(self);
}


#line 260
- (void)cancelDownloadWithLong:(jlong)fileId {
  
#line 261
  if (LOG_) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$J", @"Stopping download #", fileId));
  }
  ImActorModelModulesFileDownloadManager_QueueItem *queueItem = ImActorModelModulesFileDownloadManager_findItemWithLong_(self, fileId);
  if (queueItem == nil) {
    if (LOG_) {
      AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Not present in queue");
    }
  }
  else {
    
#line 270
    if (queueItem->isStarted_) {
      if (LOG_) {
        AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Stopping actor");
      }
      [((DKActorRef *) nil_chk(queueItem->taskRef_)) sendWithId:ImActorModelDroidkitActorsMessagesPoisonPill_get_INSTANCE_()];
      queueItem->taskRef_ = nil;
      queueItem->isStarted_ = NO;
    }
    if (LOG_) {
      AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Marking as stopped");
    }
    queueItem->isStopped_ = YES;
    
#line 283
    for (id<AMFileCallback> __strong callback in nil_chk(queueItem->callbacks_)) {
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$13 alloc] initWithAMFileCallback:callback]);
    }
  }
  
#line 293
  ImActorModelModulesFileDownloadManager_checkQueue(self);
}


#line 296
- (void)unbindDownloadWithLong:(jlong)fileId
                   withBoolean:(jboolean)autoCancel
            withAMFileCallback:(id<AMFileCallback>)callback {
  
#line 297
  if (LOG_) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$J", @"Unbind file #", fileId));
  }
  ImActorModelModulesFileDownloadManager_QueueItem *queueItem = ImActorModelModulesFileDownloadManager_findItemWithLong_(self, fileId);
  if (queueItem == nil) {
    if (LOG_) {
      AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Not present in queue");
    }
  }
  else {
    
#line 306
    if (autoCancel) {
      if (queueItem->isStarted_) {
        if (LOG_) {
          AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Stopping actor");
        }
        [((DKActorRef *) nil_chk(queueItem->taskRef_)) sendWithId:ImActorModelDroidkitActorsMessagesPoisonPill_get_INSTANCE_()];
        queueItem->taskRef_ = nil;
        queueItem->isStarted_ = NO;
      }
      
#line 316
      if (!queueItem->isStopped_) {
        if (LOG_) {
          AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Marking as stopped");
        }
        queueItem->isStopped_ = YES;
        
#line 322
        for (id<AMFileCallback> __strong c in nil_chk(queueItem->callbacks_)) {
          if (c != callback) {
            DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$14 alloc] initWithAMFileCallback:c]);
          }
        }
      }
      
#line 333
      [((JavaUtilArrayList *) nil_chk(queue_)) removeWithId:queueItem];
    }
    else {
      
#line 335
      if (LOG_) {
        AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Removing callback");
      }
      [((JavaUtilArrayList *) nil_chk(queueItem->callbacks_)) removeWithId:callback];
    }
  }
  
#line 342
  ImActorModelModulesFileDownloadManager_checkQueue(self);
}


#line 347
- (void)checkQueue {
  ImActorModelModulesFileDownloadManager_checkQueue(self);
}


#line 394
- (void)onDownloadProgressWithLong:(jlong)fileId
                         withFloat:(jfloat)progress {
  
#line 395
  if (LOG_) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$JCF", @"onDownloadProgress file #", fileId, ' ', progress));
  }
  ImActorModelModulesFileDownloadManager_QueueItem *queueItem = ImActorModelModulesFileDownloadManager_findItemWithLong_(self, fileId);
  if (queueItem == nil) {
    return;
  }
  
#line 403
  if (!((ImActorModelModulesFileDownloadManager_QueueItem *) nil_chk(queueItem))->isStarted_) {
    return;
  }
  
#line 407
  queueItem->progress_ = progress;
  
#line 409
  for (id<AMFileCallback> __strong fileCallback in nil_chk(queueItem->callbacks_)) {
    DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$16 alloc] initWithAMFileCallback:fileCallback withFloat:progress]);
  }
}


#line 419
- (void)onDownloadedWithLong:(jlong)fileId
   withAMFileSystemReference:(id<AMFileSystemReference>)reference {
  if (LOG_) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$J", @"onDownloaded file #", fileId));
  }
  ImActorModelModulesFileDownloadManager_QueueItem *queueItem = ImActorModelModulesFileDownloadManager_findItemWithLong_(self, fileId);
  if (queueItem == nil) {
    return;
  }
  
#line 428
  if (!((ImActorModelModulesFileDownloadManager_QueueItem *) nil_chk(queueItem))->isStarted_) {
    return;
  }
  
#line 432
  [((id<DKKeyValueEngine>) nil_chk(downloaded_)) addOrUpdateItemWithDKKeyValueItem:[[ImActorModelModulesFileEntityDownloaded alloc] initWithLong:[((AMFileReference *) nil_chk(queueItem->fileReference_)) getFileId] withInt:
#line 433
  [queueItem->fileReference_ getFileSize] withNSString:[((id<AMFileSystemReference>) nil_chk(reference)) getDescriptor]]];
  
#line 435
  [((JavaUtilArrayList *) nil_chk(queue_)) removeWithId:queueItem];
  [((DKActorRef *) nil_chk(queueItem->taskRef_)) sendWithId:ImActorModelDroidkitActorsMessagesPoisonPill_get_INSTANCE_()];
  
#line 438
  for (id<AMFileCallback> __strong fileCallback in nil_chk(queueItem->callbacks_)) {
    DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$17 alloc] initWithAMFileCallback:fileCallback withAMFileSystemReference:reference]);
  }
  
#line 447
  ImActorModelModulesFileDownloadManager_checkQueue(self);
}


#line 450
- (void)onDownloadErrorWithLong:(jlong)fileId {
  
#line 451
  if (LOG_) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$J", @"onDownloadError file #", fileId));
  }
  ImActorModelModulesFileDownloadManager_QueueItem *queueItem = ImActorModelModulesFileDownloadManager_findItemWithLong_(self, fileId);
  if (queueItem == nil) {
    return;
  }
  
#line 459
  if (!((ImActorModelModulesFileDownloadManager_QueueItem *) nil_chk(queueItem))->isStarted_) {
    return;
  }
  
#line 463
  [((DKActorRef *) nil_chk(queueItem->taskRef_)) sendWithId:ImActorModelDroidkitActorsMessagesPoisonPill_get_INSTANCE_()];
  queueItem->isStopped_ = YES;
  queueItem->isStarted_ = NO;
  
#line 467
  for (id<AMFileCallback> __strong fileCallback in nil_chk(queueItem->callbacks_)) {
    DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileDownloadManager_$18 alloc] initWithAMFileCallback:fileCallback]);
  }
  
#line 476
  ImActorModelModulesFileDownloadManager_checkQueue(self);
}


#line 479
- (ImActorModelModulesFileDownloadManager_QueueItem *)findItemWithLong:(jlong)id_ {
  return ImActorModelModulesFileDownloadManager_findItemWithLong_(self, id_);
}


#line 488
- (void)promoteWithLong:(jlong)id_ {
  ImActorModelModulesFileDownloadManager_promoteWithLong_(self, id_);
}


#line 519
- (void)onReceiveWithId:(id)message {
  
#line 520
  if ([message isKindOfClass:[ImActorModelModulesFileDownloadManager_BindDownload class]]) {
    ImActorModelModulesFileDownloadManager_BindDownload *requestDownload = (ImActorModelModulesFileDownloadManager_BindDownload *) check_class_cast(message, [ImActorModelModulesFileDownloadManager_BindDownload class]);
    [self bindDownloadWithAMFileReference:[((ImActorModelModulesFileDownloadManager_BindDownload *) nil_chk(requestDownload)) getFileReference] withBoolean:
#line 523
    [requestDownload isAutostart] withAMFileCallback:
#line 524
    [requestDownload getCallback]];
  }
  else
#line 525
  if ([message isKindOfClass:[ImActorModelModulesFileDownloadManager_CancelDownload class]]) {
    ImActorModelModulesFileDownloadManager_CancelDownload *cancelDownload = (ImActorModelModulesFileDownloadManager_CancelDownload *) check_class_cast(message, [ImActorModelModulesFileDownloadManager_CancelDownload class]);
    [self cancelDownloadWithLong:[((ImActorModelModulesFileDownloadManager_CancelDownload *) nil_chk(cancelDownload)) getFileId]];
  }
  else
#line 528
  if ([message isKindOfClass:[ImActorModelModulesFileDownloadManager_UnbindDownload class]]) {
    ImActorModelModulesFileDownloadManager_UnbindDownload *unbindDownload = (ImActorModelModulesFileDownloadManager_UnbindDownload *) check_class_cast(message, [ImActorModelModulesFileDownloadManager_UnbindDownload class]);
    [self unbindDownloadWithLong:[((ImActorModelModulesFileDownloadManager_UnbindDownload *) nil_chk(unbindDownload)) getFileId] withBoolean:[unbindDownload isAutocancel] withAMFileCallback:[unbindDownload getCallback]];
  }
  else
#line 531
  if ([message isKindOfClass:[ImActorModelModulesFileDownloadManager_StartDownload class]]) {
    ImActorModelModulesFileDownloadManager_StartDownload *startDownload = (ImActorModelModulesFileDownloadManager_StartDownload *) check_class_cast(message, [ImActorModelModulesFileDownloadManager_StartDownload class]);
    [self startDownloadWithAMFileReference:[((ImActorModelModulesFileDownloadManager_StartDownload *) nil_chk(startDownload)) getFileReference]];
  }
  else
#line 534
  if ([message isKindOfClass:[ImActorModelModulesFileDownloadManager_OnDownloadProgress class]]) {
    ImActorModelModulesFileDownloadManager_OnDownloadProgress *downloadProgress = (ImActorModelModulesFileDownloadManager_OnDownloadProgress *) check_class_cast(message, [ImActorModelModulesFileDownloadManager_OnDownloadProgress class]);
    [self onDownloadProgressWithLong:[((ImActorModelModulesFileDownloadManager_OnDownloadProgress *) nil_chk(downloadProgress)) getFileId] withFloat:[downloadProgress getProgress]];
  }
  else
#line 537
  if ([message isKindOfClass:[ImActorModelModulesFileDownloadManager_OnDownloaded class]]) {
    ImActorModelModulesFileDownloadManager_OnDownloaded *onDownloaded = (ImActorModelModulesFileDownloadManager_OnDownloaded *) check_class_cast(message, [ImActorModelModulesFileDownloadManager_OnDownloaded class]);
    [self onDownloadedWithLong:[((ImActorModelModulesFileDownloadManager_OnDownloaded *) nil_chk(onDownloaded)) getFileId] withAMFileSystemReference:[onDownloaded getReference]];
  }
  else
#line 540
  if ([message isKindOfClass:[ImActorModelModulesFileDownloadManager_OnDownloadedError class]]) {
    ImActorModelModulesFileDownloadManager_OnDownloadedError *error = (ImActorModelModulesFileDownloadManager_OnDownloadedError *) check_class_cast(message, [ImActorModelModulesFileDownloadManager_OnDownloadedError class]);
    [self onDownloadErrorWithLong:[((ImActorModelModulesFileDownloadManager_OnDownloadedError *) nil_chk(error)) getFileId]];
  }
  else
#line 543
  if ([message isKindOfClass:[ImActorModelModulesFileDownloadManager_RequestState class]]) {
    ImActorModelModulesFileDownloadManager_RequestState *requestState = (ImActorModelModulesFileDownloadManager_RequestState *) check_class_cast(message, [ImActorModelModulesFileDownloadManager_RequestState class]);
    [self requestStateWithLong:[((ImActorModelModulesFileDownloadManager_RequestState *) nil_chk(requestState)) getFileId] withAMFileCallback:[requestState getCallback]];
  }
  else {
    
#line 547
    [self dropWithId:message];
  }
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager *)other {
  [super copyAllFieldsTo:other];
  other->LOG_ = LOG_;
  other->queue_ = queue_;
  other->downloaded_ = downloaded_;
}

@end

void ImActorModelModulesFileDownloadManager_checkQueue(ImActorModelModulesFileDownloadManager *self) {
  
#line 348
  if (self->LOG_) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Checking queue");
  }
  
#line 352
  jint activeDownloads = 0;
  for (ImActorModelModulesFileDownloadManager_QueueItem * __strong queueItem in nil_chk(self->queue_)) {
    if (((ImActorModelModulesFileDownloadManager_QueueItem *) nil_chk(queueItem))->isStarted_) {
      activeDownloads++;
    }
  }
  
#line 359
  if (activeDownloads >= ImActorModelModulesFileDownloadManager_SIM_MAX_DOWNLOADS) {
    if (self->LOG_) {
      AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- Already have max number of simultaneous downloads");
    }
    return;
  }
  
#line 366
  ImActorModelModulesFileDownloadManager_QueueItem *pendingQueue = nil;
  for (ImActorModelModulesFileDownloadManager_QueueItem * __strong queueItem in self->queue_) {
    if (!((ImActorModelModulesFileDownloadManager_QueueItem *) nil_chk(queueItem))->isStarted_ && !queueItem->isStopped_) {
      pendingQueue = queueItem;
      break;
    }
  }
  if (pendingQueue == nil) {
    if (self->LOG_) {
      AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, @"- No work for downloading");
    }
    return;
  }
  if (self->LOG_) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileDownloadManager_TAG_, JreStrcat("$J", @"- Starting download file #", [((AMFileReference *) nil_chk(((ImActorModelModulesFileDownloadManager_QueueItem *) nil_chk(pendingQueue))->fileReference_)) getFileId]));
  }
  
#line 383
  ((ImActorModelModulesFileDownloadManager_QueueItem *) nil_chk(pendingQueue))->isStarted_ = YES;
  
#line 385
  ImActorModelModulesFileDownloadManager_QueueItem *finalPendingQueue = pendingQueue;
  pendingQueue->taskRef_ = [((DKActorSystem *) nil_chk([self system])) actorOfWithDKProps:DKProps_createWithIOSClass_withDKActorCreator_(ImActorModelModulesFileDownloadTask_class_(), [[ImActorModelModulesFileDownloadManager_$15 alloc] initWithImActorModelModulesFileDownloadManager:self withImActorModelModulesFileDownloadManager_QueueItem:finalPendingQueue]) withNSString:JreStrcat("$J", @"actor/download/task_", ImActorModelModulesUtilsRandomUtils_nextRid())];
}

ImActorModelModulesFileDownloadManager_QueueItem *ImActorModelModulesFileDownloadManager_findItemWithLong_(ImActorModelModulesFileDownloadManager *self, jlong id_) {
  
#line 480
  for (ImActorModelModulesFileDownloadManager_QueueItem * __strong q in nil_chk(self->queue_)) {
    if ([((AMFileReference *) nil_chk(((ImActorModelModulesFileDownloadManager_QueueItem *) nil_chk(q))->fileReference_)) getFileId] == id_) {
      return q;
    }
  }
  return nil;
}

void ImActorModelModulesFileDownloadManager_promoteWithLong_(ImActorModelModulesFileDownloadManager *self, jlong id_) {
  
#line 489
  for (ImActorModelModulesFileDownloadManager_QueueItem * __strong q in nil_chk(self->queue_)) {
    if ([((AMFileReference *) nil_chk(((ImActorModelModulesFileDownloadManager_QueueItem *) nil_chk(q))->fileReference_)) getFileId] == id_) {
      if (!q->isStarted_) {
        [self->queue_ removeWithId:q];
        [self->queue_ addWithInt:0 withId:q];
      }
      return;
    }
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager)


#line 500
@implementation ImActorModelModulesFileDownloadManager_QueueItem


#line 511
- (instancetype)initWithImActorModelModulesFileDownloadManager:(ImActorModelModulesFileDownloadManager *)outer$
                                           withAMFileReference:(AMFileReference *)fileReference {
  if (self = [super init]) {
    callbacks_ =
#line 504
    [[JavaUtilArrayList alloc] init];
    
#line 512
    self->fileReference_ = fileReference;
  }
  return self;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_QueueItem *)other {
  [super copyAllFieldsTo:other];
  other->fileReference_ = fileReference_;
  other->isStopped_ = isStopped_;
  other->callbacks_ = callbacks_;
  other->isStarted_ = isStarted_;
  other->progress_ = progress_;
  other->taskRef_ = taskRef_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_QueueItem)


#line 551
@implementation ImActorModelModulesFileDownloadManager_RequestState


#line 555
- (instancetype)initWithLong:(jlong)fileId
          withAMFileCallback:(id<AMFileCallback>)callback {
  if (self = [super init]) {
    
#line 556
    self->fileId_ = fileId;
    
#line 557
    self->callback_ = callback;
  }
  return self;
}


#line 560
- (jlong)getFileId {
  
#line 561
  return fileId_;
}


#line 564
- (id<AMFileCallback>)getCallback {
  
#line 565
  return callback_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_RequestState *)other {
  [super copyAllFieldsTo:other];
  other->fileId_ = fileId_;
  other->callback_ = callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_RequestState)


#line 569
@implementation ImActorModelModulesFileDownloadManager_BindDownload


#line 574
- (instancetype)initWithAMFileReference:(AMFileReference *)fileReference
                            withBoolean:(jboolean)isAutostart
                     withAMFileCallback:(id<AMFileCallback>)callback {
  if (self = [super init]) {
    
#line 575
    self->fileReference_ = fileReference;
    
#line 576
    self->isAutostart__ = isAutostart;
    
#line 577
    self->callback_ = callback;
  }
  return self;
}


#line 580
- (AMFileReference *)getFileReference {
  
#line 581
  return fileReference_;
}


#line 584
- (jboolean)isAutostart {
  
#line 585
  return isAutostart__;
}


#line 588
- (id<AMFileCallback>)getCallback {
  
#line 589
  return callback_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_BindDownload *)other {
  [super copyAllFieldsTo:other];
  other->fileReference_ = fileReference_;
  other->isAutostart__ = isAutostart__;
  other->callback_ = callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_BindDownload)


#line 593
@implementation ImActorModelModulesFileDownloadManager_StartDownload


#line 596
- (instancetype)initWithAMFileReference:(AMFileReference *)fileReference {
  if (self = [super init]) {
    
#line 597
    self->fileReference_ = fileReference;
  }
  return self;
}


#line 600
- (AMFileReference *)getFileReference {
  
#line 601
  return fileReference_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_StartDownload *)other {
  [super copyAllFieldsTo:other];
  other->fileReference_ = fileReference_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_StartDownload)


#line 605
@implementation ImActorModelModulesFileDownloadManager_CancelDownload


#line 608
- (instancetype)initWithLong:(jlong)fileId {
  if (self = [super init]) {
    
#line 609
    self->fileId_ = fileId;
  }
  return self;
}


#line 612
- (jlong)getFileId {
  
#line 613
  return fileId_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_CancelDownload *)other {
  [super copyAllFieldsTo:other];
  other->fileId_ = fileId_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_CancelDownload)


#line 617
@implementation ImActorModelModulesFileDownloadManager_UnbindDownload


#line 622
- (instancetype)initWithLong:(jlong)fileId
                 withBoolean:(jboolean)isAutocancel
          withAMFileCallback:(id<AMFileCallback>)callback {
  if (self = [super init]) {
    
#line 623
    self->fileId_ = fileId;
    
#line 624
    self->isAutocancel__ = isAutocancel;
    
#line 625
    self->callback_ = callback;
  }
  return self;
}


#line 628
- (jlong)getFileId {
  
#line 629
  return fileId_;
}


#line 632
- (id<AMFileCallback>)getCallback {
  
#line 633
  return callback_;
}


#line 636
- (jboolean)isAutocancel {
  
#line 637
  return isAutocancel__;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_UnbindDownload *)other {
  [super copyAllFieldsTo:other];
  other->fileId_ = fileId_;
  other->isAutocancel__ = isAutocancel__;
  other->callback_ = callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_UnbindDownload)


#line 641
@implementation ImActorModelModulesFileDownloadManager_OnDownloadProgress


#line 645
- (instancetype)initWithLong:(jlong)fileId
                   withFloat:(jfloat)progress {
  if (self = [super init]) {
    
#line 646
    self->fileId_ = fileId;
    
#line 647
    self->progress_ = progress;
  }
  return self;
}


#line 650
- (jlong)getFileId {
  
#line 651
  return fileId_;
}


#line 654
- (jfloat)getProgress {
  
#line 655
  return progress_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_OnDownloadProgress *)other {
  [super copyAllFieldsTo:other];
  other->fileId_ = fileId_;
  other->progress_ = progress_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_OnDownloadProgress)


#line 659
@implementation ImActorModelModulesFileDownloadManager_OnDownloaded


#line 663
- (instancetype)initWithLong:(jlong)fileId
   withAMFileSystemReference:(id<AMFileSystemReference>)reference {
  if (self = [super init]) {
    
#line 664
    self->fileId_ = fileId;
    
#line 665
    self->reference_ = reference;
  }
  return self;
}


#line 668
- (jlong)getFileId {
  
#line 669
  return fileId_;
}


#line 672
- (id<AMFileSystemReference>)getReference {
  
#line 673
  return reference_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_OnDownloaded *)other {
  [super copyAllFieldsTo:other];
  other->fileId_ = fileId_;
  other->reference_ = reference_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_OnDownloaded)


#line 677
@implementation ImActorModelModulesFileDownloadManager_OnDownloadedError


#line 680
- (instancetype)initWithLong:(jlong)fileId {
  if (self = [super init]) {
    
#line 681
    self->fileId_ = fileId;
  }
  return self;
}


#line 684
- (jlong)getFileId {
  
#line 685
  return fileId_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_OnDownloadedError *)other {
  [super copyAllFieldsTo:other];
  other->fileId_ = fileId_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_OnDownloadedError)

@implementation ImActorModelModulesFileDownloadManager_$1


#line 67
- (void)run {
  
#line 68
  [((id<AMFileCallback>) nil_chk(val$callback_)) onDownloadedWithAMFileSystemReference:val$fileSystemReference_];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0
             withAMFileSystemReference:(id<AMFileSystemReference>)capture$1 {
  val$callback_ = capture$0;
  val$fileSystemReference_ = capture$1;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$1 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
  other->val$fileSystemReference_ = val$fileSystemReference_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$1)

@implementation ImActorModelModulesFileDownloadManager_$2


#line 90
- (void)run {
  
#line 91
  [((id<AMFileCallback>) nil_chk(val$callback_)) onNotDownloaded];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$2 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$2)

@implementation ImActorModelModulesFileDownloadManager_$3


#line 100
- (void)run {
  
#line 101
  [((id<AMFileCallback>) nil_chk(val$callback_)) onDownloadingWithFloat:val$progress_];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0
                             withFloat:(jfloat)capture$1 {
  val$callback_ = capture$0;
  val$progress_ = capture$1;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$3 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
  other->val$progress_ = val$progress_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$3)

@implementation ImActorModelModulesFileDownloadManager_$4


#line 108
- (void)run {
  
#line 109
  [((id<AMFileCallback>) nil_chk(val$callback_)) onNotDownloaded];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$4 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$4)

@implementation ImActorModelModulesFileDownloadManager_$5


#line 115
- (void)run {
  
#line 116
  [((id<AMFileCallback>) nil_chk(val$callback_)) onDownloadingWithFloat:0];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$5 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$5)

@implementation ImActorModelModulesFileDownloadManager_$6


#line 141
- (void)run {
  
#line 142
  [((id<AMFileCallback>) nil_chk(val$callback_)) onDownloadedWithAMFileSystemReference:val$fileSystemReference_];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0
             withAMFileSystemReference:(id<AMFileSystemReference>)capture$1 {
  val$callback_ = capture$0;
  val$fileSystemReference_ = capture$1;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$6 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
  other->val$fileSystemReference_ = val$fileSystemReference_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$6)

@implementation ImActorModelModulesFileDownloadManager_$7


#line 173
- (void)run {
  
#line 174
  [((id<AMFileCallback>) nil_chk(val$callback_)) onDownloadingWithFloat:0];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$7 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$7)

@implementation ImActorModelModulesFileDownloadManager_$8


#line 181
- (void)run {
  
#line 182
  [((id<AMFileCallback>) nil_chk(val$callback_)) onNotDownloaded];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$8 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$8)

@implementation ImActorModelModulesFileDownloadManager_$9


#line 200
- (void)run {
  
#line 201
  [((id<AMFileCallback>) nil_chk(val$callback_)) onNotDownloaded];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$9 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$9)

@implementation ImActorModelModulesFileDownloadManager_$10


#line 209
- (void)run {
  
#line 210
  [((id<AMFileCallback>) nil_chk(val$callback_)) onDownloadingWithFloat:val$progress_];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0
                             withFloat:(jfloat)capture$1 {
  val$callback_ = capture$0;
  val$progress_ = capture$1;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$10 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
  other->val$progress_ = val$progress_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$10)

@implementation ImActorModelModulesFileDownloadManager_$11


#line 216
- (void)run {
  
#line 217
  [((id<AMFileCallback>) nil_chk(val$callback_)) onDownloadingWithFloat:0];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$11 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$11)

@implementation ImActorModelModulesFileDownloadManager_$12


#line 248
- (void)run {
  
#line 249
  [((id<AMFileCallback>) nil_chk(val$callback_)) onDownloadingWithFloat:0];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$12 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$12)

@implementation ImActorModelModulesFileDownloadManager_$13


#line 286
- (void)run {
  
#line 287
  [((id<AMFileCallback>) nil_chk(val$callback_)) onNotDownloaded];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$13 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$13)

@implementation ImActorModelModulesFileDownloadManager_$14


#line 326
- (void)run {
  
#line 327
  [((id<AMFileCallback>) nil_chk(val$c_)) onNotDownloaded];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$c_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$14 *)other {
  [super copyAllFieldsTo:other];
  other->val$c_ = val$c_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$14)

@implementation ImActorModelModulesFileDownloadManager_$15


#line 388
- (ImActorModelModulesFileDownloadTask *)create {
  
#line 389
  return [[ImActorModelModulesFileDownloadTask alloc] initWithAMFileReference:((ImActorModelModulesFileDownloadManager_QueueItem *) nil_chk(val$finalPendingQueue_))->fileReference_ withDKActorRef:[this$0_ self__] withImActorModelModulesModules:[this$0_ modules]];
}

- (instancetype)initWithImActorModelModulesFileDownloadManager:(ImActorModelModulesFileDownloadManager *)outer$
          withImActorModelModulesFileDownloadManager_QueueItem:(ImActorModelModulesFileDownloadManager_QueueItem *)capture$0 {
  this$0_ = outer$;
  val$finalPendingQueue_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$15 *)other {
  [super copyAllFieldsTo:other];
  other->this$0_ = this$0_;
  other->val$finalPendingQueue_ = val$finalPendingQueue_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$15)

@implementation ImActorModelModulesFileDownloadManager_$16


#line 412
- (void)run {
  [((id<AMFileCallback>) nil_chk(val$fileCallback_)) onDownloadingWithFloat:val$progress_];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0
                             withFloat:(jfloat)capture$1 {
  val$fileCallback_ = capture$0;
  val$progress_ = capture$1;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$16 *)other {
  [super copyAllFieldsTo:other];
  other->val$fileCallback_ = val$fileCallback_;
  other->val$progress_ = val$progress_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$16)

@implementation ImActorModelModulesFileDownloadManager_$17


#line 441
- (void)run {
  
#line 442
  [((id<AMFileCallback>) nil_chk(val$fileCallback_)) onDownloadedWithAMFileSystemReference:val$reference_];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0
             withAMFileSystemReference:(id<AMFileSystemReference>)capture$1 {
  val$fileCallback_ = capture$0;
  val$reference_ = capture$1;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$17 *)other {
  [super copyAllFieldsTo:other];
  other->val$fileCallback_ = val$fileCallback_;
  other->val$reference_ = val$reference_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$17)

@implementation ImActorModelModulesFileDownloadManager_$18


#line 470
- (void)run {
  
#line 471
  [((id<AMFileCallback>) nil_chk(val$fileCallback_)) onNotDownloaded];
}

- (instancetype)initWithAMFileCallback:(id<AMFileCallback>)capture$0 {
  val$fileCallback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileDownloadManager_$18 *)other {
  [super copyAllFieldsTo:other];
  other->val$fileCallback_ = val$fileCallback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileDownloadManager_$18)
