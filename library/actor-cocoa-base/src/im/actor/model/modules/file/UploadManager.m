//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/library/actor-cocoa-base/build/java/im/actor/model/modules/file/UploadManager.java
//

#include "IOSClass.h"
#include "J2ObjC_source.h"
#include "im/actor/model/droidkit/actors/Actor.h"
#include "im/actor/model/droidkit/actors/ActorRef.h"
#include "im/actor/model/droidkit/actors/ActorSystem.h"
#include "im/actor/model/droidkit/actors/Environment.h"
#include "im/actor/model/droidkit/actors/Props.h"
#include "im/actor/model/droidkit/actors/messages/PoisonPill.h"
#include "im/actor/model/droidkit/engine/KeyValueEngine.h"
#include "im/actor/model/entity/FileReference.h"
#include "im/actor/model/files/FileSystemReference.h"
#include "im/actor/model/log/Log.h"
#include "im/actor/model/modules/Files.h"
#include "im/actor/model/modules/Modules.h"
#include "im/actor/model/modules/file/UploadManager.h"
#include "im/actor/model/modules/file/UploadTask.h"
#include "im/actor/model/modules/file/entity/Downloaded.h"
#include "im/actor/model/modules/utils/ModuleActor.h"
#include "im/actor/model/modules/utils/RandomUtils.h"
#include "im/actor/model/viewmodel/UploadCallback.h"
#include "java/util/ArrayList.h"

__attribute__((unused)) static void ImActorModelModulesFileUploadManager_checkQueue(ImActorModelModulesFileUploadManager *self);
__attribute__((unused)) static ImActorModelModulesFileUploadManager_QueueItem *ImActorModelModulesFileUploadManager_findItemWithLong_(ImActorModelModulesFileUploadManager *self, jlong rid);

@interface ImActorModelModulesFileUploadManager () {
 @public
  JavaUtilArrayList *queue_;
}

- (void)checkQueue;

- (ImActorModelModulesFileUploadManager_QueueItem *)findItemWithLong:(jlong)rid;
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager, queue_, JavaUtilArrayList *)

@interface ImActorModelModulesFileUploadManager_QueueItem () {
 @public
  jlong rid_;
  NSString *fileDescriptor_;
  jboolean isStopped_;
  jboolean isStarted_;
  jfloat progress_;
  DKActorRef *taskRef_;
  DKActorRef *requestActor_;
  NSString *fileName_;
  JavaUtilArrayList *callbacks_;
}
- (instancetype)initWithImActorModelModulesFileUploadManager:(ImActorModelModulesFileUploadManager *)outer$
                                                    withLong:(jlong)rid
                                                withNSString:(NSString *)fileDescriptor
                                                withNSString:(NSString *)fileName
                                              withDKActorRef:(DKActorRef *)requestActor;
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_QueueItem, fileDescriptor_, NSString *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_QueueItem, taskRef_, DKActorRef *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_QueueItem, requestActor_, DKActorRef *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_QueueItem, fileName_, NSString *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_QueueItem, callbacks_, JavaUtilArrayList *)

@interface ImActorModelModulesFileUploadManager_StartUpload () {
 @public
  jlong rid_;
  NSString *fileDescriptor_;
  NSString *fileName_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_StartUpload, fileDescriptor_, NSString *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_StartUpload, fileName_, NSString *)

@interface ImActorModelModulesFileUploadManager_BindUpload () {
 @public
  jlong rid_;
  id<AMUploadCallback> callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_BindUpload, callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_UnbindUpload () {
 @public
  jlong rid_;
  id<AMUploadCallback> callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_UnbindUpload, callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_StopUpload () {
 @public
  jlong rid_;
}
@end

@interface ImActorModelModulesFileUploadManager_UploadTaskError () {
 @public
  jlong rid_;
}
@end

@interface ImActorModelModulesFileUploadManager_UploadTaskProgress () {
 @public
  jlong rid_;
  jfloat progress_;
}
@end

@interface ImActorModelModulesFileUploadManager_UploadTaskComplete () {
 @public
  jlong rid_;
  AMFileReference *location_;
  id<AMFileSystemReference> reference_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_UploadTaskComplete, location_, AMFileReference *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_UploadTaskComplete, reference_, id<AMFileSystemReference>)

@interface ImActorModelModulesFileUploadManager_UploadCompleted () {
 @public
  jlong rid_;
  AMFileReference *fileReference_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_UploadCompleted, fileReference_, AMFileReference *)

@interface ImActorModelModulesFileUploadManager_UploadError () {
 @public
  jlong rid_;
}
@end

@interface ImActorModelModulesFileUploadManager_RequestState () {
 @public
  jlong rid_;
  id<AMUploadCallback> callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_RequestState, callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_PauseUpload () {
 @public
  jlong rid_;
}
@end

@interface ImActorModelModulesFileUploadManager_ResumeUpload () {
 @public
  jlong rid_;
}
@end

@interface ImActorModelModulesFileUploadManager_$1 () {
 @public
  id<AMUploadCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$1, val$callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$2 () {
 @public
  id<AMUploadCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$2, val$callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$3 () {
 @public
  id<AMUploadCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$3, val$callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$4 () {
 @public
  id<AMUploadCallback> val$callback_;
  jfloat val$progress_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$4, val$callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$5 () {
 @public
  id<AMUploadCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$5, val$callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$6 () {
 @public
  id<AMUploadCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$6, val$callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$7 () {
 @public
  id<AMUploadCallback> val$callback_;
  jfloat val$progress_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$7, val$callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$8 () {
 @public
  id<AMUploadCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$8, val$callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$9 () {
 @public
  id<AMUploadCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$9, val$callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$10 () {
 @public
  id<AMUploadCallback> val$callback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$10, val$callback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$11 () {
 @public
  id<AMUploadCallback> val$fileCallback_;
  jfloat val$progress_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$11, val$fileCallback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$12 () {
 @public
  id<AMUploadCallback> val$fileCallback_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$12, val$fileCallback_, id<AMUploadCallback>)

@interface ImActorModelModulesFileUploadManager_$13 () {
 @public
  ImActorModelModulesFileUploadManager *this$0_;
  ImActorModelModulesFileUploadManager_QueueItem *val$finalPendingQueue_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$13, this$0_, ImActorModelModulesFileUploadManager *)
J2OBJC_FIELD_SETTER(ImActorModelModulesFileUploadManager_$13, val$finalPendingQueue_, ImActorModelModulesFileUploadManager_QueueItem *)

@implementation ImActorModelModulesFileUploadManager

NSString * ImActorModelModulesFileUploadManager_TAG_ = @"UploadManager";

- (instancetype)initWithImActorModelModulesModules:(ImActorModelModulesModules *)messenger {
  if (self = [super initWithImActorModelModulesModules:messenger]) {
    queue_ = [[JavaUtilArrayList alloc] init];
  }
  return self;
}

- (void)startUploadWithLong:(jlong)rid
               withNSString:(NSString *)descriptor
               withNSString:(NSString *)fileName
             withDKActorRef:(DKActorRef *)requestActor {
  AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, JreStrcat("$J$$", @"Starting upload #", rid, @" with descriptor ", descriptor));
  ImActorModelModulesFileUploadManager_QueueItem *queueItem = [[ImActorModelModulesFileUploadManager_QueueItem alloc] initWithImActorModelModulesFileUploadManager:self withLong:rid withNSString:descriptor withNSString:fileName withDKActorRef:requestActor];
  queueItem->isStopped_ = NO;
  [((JavaUtilArrayList *) nil_chk(queue_)) addWithId:queueItem];
  ImActorModelModulesFileUploadManager_checkQueue(self);
}

- (void)stopUploadWithLong:(jlong)rid {
  AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, JreStrcat("$J", @"Stopping download #", rid));
  ImActorModelModulesFileUploadManager_QueueItem *queueItem = ImActorModelModulesFileUploadManager_findItemWithLong_(self, rid);
  if (queueItem == nil) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, @"- Not present in queue");
  }
  else {
    if (queueItem->isStarted_) {
      AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, @"- Stopping actor");
      [((DKActorRef *) nil_chk(queueItem->taskRef_)) sendWithId:ImActorModelDroidkitActorsMessagesPoisonPill_get_INSTANCE_()];
      queueItem->taskRef_ = nil;
      queueItem->isStarted_ = NO;
    }
    [((JavaUtilArrayList *) nil_chk(queue_)) removeWithId:queueItem];
    for (id<AMUploadCallback> __strong callback in nil_chk(queueItem->callbacks_)) {
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$1 alloc] initWithAMUploadCallback:callback]);
    }
  }
  ImActorModelModulesFileUploadManager_checkQueue(self);
}

- (void)bindUploadWithLong:(jlong)rid
      withAMUploadCallback:(id<AMUploadCallback>)callback {
  ImActorModelModulesFileUploadManager_QueueItem *queueItem = ImActorModelModulesFileUploadManager_findItemWithLong_(self, rid);
  if (queueItem == nil) {
    DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$2 alloc] initWithAMUploadCallback:callback]);
  }
  else {
    if (queueItem->isStopped_) {
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$3 alloc] initWithAMUploadCallback:callback]);
    }
    else {
      jfloat progress = queueItem->progress_;
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$4 alloc] initWithAMUploadCallback:callback withFloat:progress]);
    }
    [((JavaUtilArrayList *) nil_chk(queueItem->callbacks_)) addWithId:callback];
  }
}

- (void)unbindUploadWithLong:(jlong)rid
        withAMUploadCallback:(id<AMUploadCallback>)callback {
  ImActorModelModulesFileUploadManager_QueueItem *queueItem = ImActorModelModulesFileUploadManager_findItemWithLong_(self, rid);
  if (queueItem != nil) {
    [((JavaUtilArrayList *) nil_chk(queueItem->callbacks_)) removeWithId:callback];
  }
}

- (void)requestStateWithLong:(jlong)rid
        withAMUploadCallback:(id<AMUploadCallback>)callback {
  ImActorModelModulesFileUploadManager_QueueItem *queueItem = ImActorModelModulesFileUploadManager_findItemWithLong_(self, rid);
  if (queueItem == nil) {
    DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$5 alloc] initWithAMUploadCallback:callback]);
  }
  else {
    if (queueItem->isStopped_) {
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$6 alloc] initWithAMUploadCallback:callback]);
    }
    else {
      jfloat progress = queueItem->progress_;
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$7 alloc] initWithAMUploadCallback:callback withFloat:progress]);
    }
  }
}

- (void)resumeUploadWithLong:(jlong)rid {
  ImActorModelModulesFileUploadManager_QueueItem *queueItem = ImActorModelModulesFileUploadManager_findItemWithLong_(self, rid);
  if (queueItem != nil) {
    if (queueItem->isStarted_) {
      return;
    }
    if (queueItem->isStopped_) {
      queueItem->isStopped_ = NO;
    }
    queueItem->progress_ = 0;
    for (id<AMUploadCallback> __strong callback in nil_chk(queueItem->callbacks_)) {
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$8 alloc] initWithAMUploadCallback:callback]);
    }
    ImActorModelModulesFileUploadManager_checkQueue(self);
  }
}

- (void)pauseUploadWithLong:(jlong)rid {
  ImActorModelModulesFileUploadManager_QueueItem *queueItem = ImActorModelModulesFileUploadManager_findItemWithLong_(self, rid);
  if (queueItem != nil) {
    if (queueItem->isStarted_) {
      [((DKActorRef *) nil_chk(queueItem->taskRef_)) sendWithId:ImActorModelDroidkitActorsMessagesPoisonPill_get_INSTANCE_()];
      queueItem->taskRef_ = nil;
      queueItem->isStarted_ = NO;
    }
    queueItem->isStopped_ = YES;
    for (id<AMUploadCallback> __strong callback in nil_chk(queueItem->callbacks_)) {
      DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$9 alloc] initWithAMUploadCallback:callback]);
    }
  }
}

- (void)onUploadTaskErrorWithLong:(jlong)rid {
  AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, JreStrcat("$J$", @"Upload #", rid, @" error"));
  ImActorModelModulesFileUploadManager_QueueItem *queueItem = ImActorModelModulesFileUploadManager_findItemWithLong_(self, rid);
  if (queueItem == nil) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, @"- Nothing found");
    return;
  }
  if (!((ImActorModelModulesFileUploadManager_QueueItem *) nil_chk(queueItem))->isStarted_) {
    return;
  }
  [((DKActorRef *) nil_chk(queueItem->taskRef_)) sendWithId:ImActorModelDroidkitActorsMessagesPoisonPill_get_INSTANCE_()];
  queueItem->isStopped_ = YES;
  queueItem->isStarted_ = NO;
  for (id<AMUploadCallback> __strong callback in nil_chk(queueItem->callbacks_)) {
    DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$10 alloc] initWithAMUploadCallback:callback]);
  }
  [((DKActorRef *) nil_chk(queueItem->requestActor_)) sendWithId:[[ImActorModelModulesFileUploadManager_UploadError alloc] initWithLong:rid]];
  ImActorModelModulesFileUploadManager_checkQueue(self);
}

- (void)onUploadTaskProgressWithLong:(jlong)rid
                           withFloat:(jfloat)progress {
  AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, JreStrcat("$J$F", @"Upload #", rid, @" progress ", progress));
  ImActorModelModulesFileUploadManager_QueueItem *queueItem = ImActorModelModulesFileUploadManager_findItemWithLong_(self, rid);
  if (queueItem == nil) {
    return;
  }
  if (!((ImActorModelModulesFileUploadManager_QueueItem *) nil_chk(queueItem))->isStarted_) {
    return;
  }
  queueItem->progress_ = progress;
  for (id<AMUploadCallback> __strong fileCallback in nil_chk(queueItem->callbacks_)) {
    DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$11 alloc] initWithAMUploadCallback:fileCallback withFloat:progress]);
  }
}

- (void)onUploadTaskCompleteWithLong:(jlong)rid
                 withAMFileReference:(AMFileReference *)fileReference
           withAMFileSystemReference:(id<AMFileSystemReference>)reference {
  AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, JreStrcat("$J$", @"Upload #", rid, @" complete"));
  ImActorModelModulesFileUploadManager_QueueItem *queueItem = ImActorModelModulesFileUploadManager_findItemWithLong_(self, rid);
  if (queueItem == nil) {
    return;
  }
  if (!((ImActorModelModulesFileUploadManager_QueueItem *) nil_chk(queueItem))->isStarted_) {
    return;
  }
  [((JavaUtilArrayList *) nil_chk(queue_)) removeWithId:queueItem];
  [((DKActorRef *) nil_chk(queueItem->taskRef_)) sendWithId:ImActorModelDroidkitActorsMessagesPoisonPill_get_INSTANCE_()];
  [((id<DKKeyValueEngine>) nil_chk([((ImActorModelModulesFiles *) nil_chk([((ImActorModelModulesModules *) nil_chk([self modules])) getFilesModule])) getDownloadedEngine])) addOrUpdateItemWithDKKeyValueItem:[[ImActorModelModulesFileEntityDownloaded alloc] initWithLong:[((AMFileReference *) nil_chk(fileReference)) getFileId] withInt:[fileReference getFileSize] withNSString:[((id<AMFileSystemReference>) nil_chk(reference)) getDescriptor]]];
  for (id<AMUploadCallback> __strong fileCallback in nil_chk(queueItem->callbacks_)) {
    DKEnvironment_dispatchCallbackWithJavaLangRunnable_([[ImActorModelModulesFileUploadManager_$12 alloc] initWithAMUploadCallback:fileCallback]);
  }
  [((DKActorRef *) nil_chk(queueItem->requestActor_)) sendWithId:[[ImActorModelModulesFileUploadManager_UploadCompleted alloc] initWithLong:rid withAMFileReference:fileReference]];
  ImActorModelModulesFileUploadManager_checkQueue(self);
}

- (void)checkQueue {
  ImActorModelModulesFileUploadManager_checkQueue(self);
}

- (ImActorModelModulesFileUploadManager_QueueItem *)findItemWithLong:(jlong)rid {
  return ImActorModelModulesFileUploadManager_findItemWithLong_(self, rid);
}

- (void)onReceiveWithId:(id)message {
  if ([message isKindOfClass:[ImActorModelModulesFileUploadManager_StartUpload class]]) {
    ImActorModelModulesFileUploadManager_StartUpload *startUpload = (ImActorModelModulesFileUploadManager_StartUpload *) check_class_cast(message, [ImActorModelModulesFileUploadManager_StartUpload class]);
    [self startUploadWithLong:[((ImActorModelModulesFileUploadManager_StartUpload *) nil_chk(startUpload)) getRid] withNSString:[startUpload getFileDescriptor] withNSString:[startUpload getFileName] withDKActorRef:[self sender]];
  }
  else if ([message isKindOfClass:[ImActorModelModulesFileUploadManager_StopUpload class]]) {
    ImActorModelModulesFileUploadManager_StopUpload *cancelUpload = (ImActorModelModulesFileUploadManager_StopUpload *) check_class_cast(message, [ImActorModelModulesFileUploadManager_StopUpload class]);
    [self stopUploadWithLong:[((ImActorModelModulesFileUploadManager_StopUpload *) nil_chk(cancelUpload)) getRid]];
  }
  else if ([message isKindOfClass:[ImActorModelModulesFileUploadManager_UploadTaskError class]]) {
    ImActorModelModulesFileUploadManager_UploadTaskError *uploadTaskError = (ImActorModelModulesFileUploadManager_UploadTaskError *) check_class_cast(message, [ImActorModelModulesFileUploadManager_UploadTaskError class]);
    [self onUploadTaskErrorWithLong:[((ImActorModelModulesFileUploadManager_UploadTaskError *) nil_chk(uploadTaskError)) getRid]];
  }
  else if ([message isKindOfClass:[ImActorModelModulesFileUploadManager_UploadTaskProgress class]]) {
    ImActorModelModulesFileUploadManager_UploadTaskProgress *taskProgress = (ImActorModelModulesFileUploadManager_UploadTaskProgress *) check_class_cast(message, [ImActorModelModulesFileUploadManager_UploadTaskProgress class]);
    [self onUploadTaskProgressWithLong:[((ImActorModelModulesFileUploadManager_UploadTaskProgress *) nil_chk(taskProgress)) getRid] withFloat:[taskProgress getProgress]];
  }
  else if ([message isKindOfClass:[ImActorModelModulesFileUploadManager_UploadTaskComplete class]]) {
    ImActorModelModulesFileUploadManager_UploadTaskComplete *taskComplete = (ImActorModelModulesFileUploadManager_UploadTaskComplete *) check_class_cast(message, [ImActorModelModulesFileUploadManager_UploadTaskComplete class]);
    [self onUploadTaskCompleteWithLong:[((ImActorModelModulesFileUploadManager_UploadTaskComplete *) nil_chk(taskComplete)) getRid] withAMFileReference:[taskComplete getLocation] withAMFileSystemReference:[taskComplete getReference]];
  }
  else if ([message isKindOfClass:[ImActorModelModulesFileUploadManager_BindUpload class]]) {
    ImActorModelModulesFileUploadManager_BindUpload *bindUpload = (ImActorModelModulesFileUploadManager_BindUpload *) check_class_cast(message, [ImActorModelModulesFileUploadManager_BindUpload class]);
    [self bindUploadWithLong:[((ImActorModelModulesFileUploadManager_BindUpload *) nil_chk(bindUpload)) getRid] withAMUploadCallback:[bindUpload getCallback]];
  }
  else if ([message isKindOfClass:[ImActorModelModulesFileUploadManager_UnbindUpload class]]) {
    ImActorModelModulesFileUploadManager_UnbindUpload *unbindUpload = (ImActorModelModulesFileUploadManager_UnbindUpload *) check_class_cast(message, [ImActorModelModulesFileUploadManager_UnbindUpload class]);
    [self unbindUploadWithLong:[((ImActorModelModulesFileUploadManager_UnbindUpload *) nil_chk(unbindUpload)) getRid] withAMUploadCallback:[unbindUpload getCallback]];
  }
  else if ([message isKindOfClass:[ImActorModelModulesFileUploadManager_RequestState class]]) {
    ImActorModelModulesFileUploadManager_RequestState *requestState = (ImActorModelModulesFileUploadManager_RequestState *) check_class_cast(message, [ImActorModelModulesFileUploadManager_RequestState class]);
    [self requestStateWithLong:[((ImActorModelModulesFileUploadManager_RequestState *) nil_chk(requestState)) getRid] withAMUploadCallback:[requestState getCallback]];
  }
  else if ([message isKindOfClass:[ImActorModelModulesFileUploadManager_PauseUpload class]]) {
    ImActorModelModulesFileUploadManager_PauseUpload *pauseUpload = (ImActorModelModulesFileUploadManager_PauseUpload *) check_class_cast(message, [ImActorModelModulesFileUploadManager_PauseUpload class]);
    [self pauseUploadWithLong:[((ImActorModelModulesFileUploadManager_PauseUpload *) nil_chk(pauseUpload)) getRid]];
  }
  else if ([message isKindOfClass:[ImActorModelModulesFileUploadManager_ResumeUpload class]]) {
    ImActorModelModulesFileUploadManager_ResumeUpload *resumeUpload = (ImActorModelModulesFileUploadManager_ResumeUpload *) check_class_cast(message, [ImActorModelModulesFileUploadManager_ResumeUpload class]);
    [self resumeUploadWithLong:[((ImActorModelModulesFileUploadManager_ResumeUpload *) nil_chk(resumeUpload)) getRid]];
  }
  else {
    [self dropWithId:message];
  }
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager *)other {
  [super copyAllFieldsTo:other];
  other->queue_ = queue_;
}

@end

void ImActorModelModulesFileUploadManager_checkQueue(ImActorModelModulesFileUploadManager *self) {
  AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, @"- Checking queue");
  jint activeUploads = 0;
  for (ImActorModelModulesFileUploadManager_QueueItem * __strong queueItem in nil_chk(self->queue_)) {
    if (((ImActorModelModulesFileUploadManager_QueueItem *) nil_chk(queueItem))->isStarted_) {
      activeUploads++;
    }
  }
  if (activeUploads >= ImActorModelModulesFileUploadManager_SIM_MAX_UPLOADS) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, @"- Already have max number of simultaneous uploads");
    return;
  }
  ImActorModelModulesFileUploadManager_QueueItem *pendingQueue = nil;
  for (ImActorModelModulesFileUploadManager_QueueItem * __strong queueItem in self->queue_) {
    if (!((ImActorModelModulesFileUploadManager_QueueItem *) nil_chk(queueItem))->isStarted_ && !queueItem->isStopped_) {
      pendingQueue = queueItem;
      break;
    }
  }
  if (pendingQueue == nil) {
    AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, @"- No work for downloading");
    return;
  }
  AMLog_dWithNSString_withNSString_(ImActorModelModulesFileUploadManager_TAG_, JreStrcat("$$", @"- Starting upload file #", ((ImActorModelModulesFileUploadManager_QueueItem *) nil_chk(pendingQueue))->fileDescriptor_));
  pendingQueue->isStarted_ = YES;
  ImActorModelModulesFileUploadManager_QueueItem *finalPendingQueue = pendingQueue;
  pendingQueue->taskRef_ = [((DKActorSystem *) nil_chk([self system])) actorOfWithDKProps:DKProps_createWithIOSClass_withDKActorCreator_(ImActorModelModulesFileUploadTask_class_(), [[ImActorModelModulesFileUploadManager_$13 alloc] initWithImActorModelModulesFileUploadManager:self withImActorModelModulesFileUploadManager_QueueItem:finalPendingQueue]) withNSString:JreStrcat("$J", @"actor/upload/task_", ImActorModelModulesUtilsRandomUtils_nextRid())];
}

ImActorModelModulesFileUploadManager_QueueItem *ImActorModelModulesFileUploadManager_findItemWithLong_(ImActorModelModulesFileUploadManager *self, jlong rid) {
  for (ImActorModelModulesFileUploadManager_QueueItem * __strong q in nil_chk(self->queue_)) {
    if (((ImActorModelModulesFileUploadManager_QueueItem *) nil_chk(q))->rid_ == rid) {
      return q;
    }
  }
  return nil;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager)

@implementation ImActorModelModulesFileUploadManager_QueueItem

- (instancetype)initWithImActorModelModulesFileUploadManager:(ImActorModelModulesFileUploadManager *)outer$
                                                    withLong:(jlong)rid
                                                withNSString:(NSString *)fileDescriptor
                                                withNSString:(NSString *)fileName
                                              withDKActorRef:(DKActorRef *)requestActor {
  if (self = [super init]) {
    callbacks_ = [[JavaUtilArrayList alloc] init];
    self->rid_ = rid;
    self->fileDescriptor_ = fileDescriptor;
    self->requestActor_ = requestActor;
    self->fileName_ = fileName;
  }
  return self;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_QueueItem *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
  other->fileDescriptor_ = fileDescriptor_;
  other->isStopped_ = isStopped_;
  other->isStarted_ = isStarted_;
  other->progress_ = progress_;
  other->taskRef_ = taskRef_;
  other->requestActor_ = requestActor_;
  other->fileName_ = fileName_;
  other->callbacks_ = callbacks_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_QueueItem)

@implementation ImActorModelModulesFileUploadManager_StartUpload

- (instancetype)initWithLong:(jlong)rid
                withNSString:(NSString *)fileDescriptor
                withNSString:(NSString *)fileName {
  if (self = [super init]) {
    self->rid_ = rid;
    self->fileDescriptor_ = fileDescriptor;
    self->fileName_ = fileName;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (NSString *)getFileDescriptor {
  return fileDescriptor_;
}

- (NSString *)getFileName {
  return fileName_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_StartUpload *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
  other->fileDescriptor_ = fileDescriptor_;
  other->fileName_ = fileName_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_StartUpload)

@implementation ImActorModelModulesFileUploadManager_BindUpload

- (instancetype)initWithLong:(jlong)rid
        withAMUploadCallback:(id<AMUploadCallback>)callback {
  if (self = [super init]) {
    self->rid_ = rid;
    self->callback_ = callback;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (id<AMUploadCallback>)getCallback {
  return callback_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_BindUpload *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
  other->callback_ = callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_BindUpload)

@implementation ImActorModelModulesFileUploadManager_UnbindUpload

- (instancetype)initWithLong:(jlong)rid
        withAMUploadCallback:(id<AMUploadCallback>)callback {
  if (self = [super init]) {
    self->rid_ = rid;
    self->callback_ = callback;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (id<AMUploadCallback>)getCallback {
  return callback_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_UnbindUpload *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
  other->callback_ = callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_UnbindUpload)

@implementation ImActorModelModulesFileUploadManager_StopUpload

- (instancetype)initWithLong:(jlong)rid {
  if (self = [super init]) {
    self->rid_ = rid;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_StopUpload *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_StopUpload)

@implementation ImActorModelModulesFileUploadManager_UploadTaskError

- (instancetype)initWithLong:(jlong)rid {
  if (self = [super init]) {
    self->rid_ = rid;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_UploadTaskError *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_UploadTaskError)

@implementation ImActorModelModulesFileUploadManager_UploadTaskProgress

- (instancetype)initWithLong:(jlong)rid
                   withFloat:(jfloat)progress {
  if (self = [super init]) {
    self->rid_ = rid;
    self->progress_ = progress;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (jfloat)getProgress {
  return progress_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_UploadTaskProgress *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
  other->progress_ = progress_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_UploadTaskProgress)

@implementation ImActorModelModulesFileUploadManager_UploadTaskComplete

- (instancetype)initWithLong:(jlong)rid
         withAMFileReference:(AMFileReference *)location
   withAMFileSystemReference:(id<AMFileSystemReference>)reference {
  if (self = [super init]) {
    self->rid_ = rid;
    self->location_ = location;
    self->reference_ = reference;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (id<AMFileSystemReference>)getReference {
  return reference_;
}

- (AMFileReference *)getLocation {
  return location_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_UploadTaskComplete *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
  other->location_ = location_;
  other->reference_ = reference_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_UploadTaskComplete)

@implementation ImActorModelModulesFileUploadManager_UploadCompleted

- (instancetype)initWithLong:(jlong)rid
         withAMFileReference:(AMFileReference *)fileReference {
  if (self = [super init]) {
    self->rid_ = rid;
    self->fileReference_ = fileReference;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (AMFileReference *)getFileReference {
  return fileReference_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_UploadCompleted *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
  other->fileReference_ = fileReference_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_UploadCompleted)

@implementation ImActorModelModulesFileUploadManager_UploadError

- (instancetype)initWithLong:(jlong)rid {
  if (self = [super init]) {
    self->rid_ = rid;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_UploadError *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_UploadError)

@implementation ImActorModelModulesFileUploadManager_RequestState

- (instancetype)initWithLong:(jlong)rid
        withAMUploadCallback:(id<AMUploadCallback>)callback {
  if (self = [super init]) {
    self->rid_ = rid;
    self->callback_ = callback;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (id<AMUploadCallback>)getCallback {
  return callback_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_RequestState *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
  other->callback_ = callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_RequestState)

@implementation ImActorModelModulesFileUploadManager_PauseUpload

- (instancetype)initWithLong:(jlong)rid {
  if (self = [super init]) {
    self->rid_ = rid;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_PauseUpload *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_PauseUpload)

@implementation ImActorModelModulesFileUploadManager_ResumeUpload

- (instancetype)initWithLong:(jlong)rid {
  if (self = [super init]) {
    self->rid_ = rid;
  }
  return self;
}

- (jlong)getRid {
  return rid_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_ResumeUpload *)other {
  [super copyAllFieldsTo:other];
  other->rid_ = rid_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_ResumeUpload)

@implementation ImActorModelModulesFileUploadManager_$1

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$callback_)) onNotUploading];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$1 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$1)

@implementation ImActorModelModulesFileUploadManager_$2

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$callback_)) onNotUploading];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$2 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$2)

@implementation ImActorModelModulesFileUploadManager_$3

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$callback_)) onNotUploading];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$3 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$3)

@implementation ImActorModelModulesFileUploadManager_$4

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$callback_)) onUploadingWithFloat:val$progress_];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0
                               withFloat:(jfloat)capture$1 {
  val$callback_ = capture$0;
  val$progress_ = capture$1;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$4 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
  other->val$progress_ = val$progress_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$4)

@implementation ImActorModelModulesFileUploadManager_$5

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$callback_)) onNotUploading];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$5 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$5)

@implementation ImActorModelModulesFileUploadManager_$6

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$callback_)) onNotUploading];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$6 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$6)

@implementation ImActorModelModulesFileUploadManager_$7

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$callback_)) onUploadingWithFloat:val$progress_];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0
                               withFloat:(jfloat)capture$1 {
  val$callback_ = capture$0;
  val$progress_ = capture$1;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$7 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
  other->val$progress_ = val$progress_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$7)

@implementation ImActorModelModulesFileUploadManager_$8

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$callback_)) onUploadingWithFloat:0];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$8 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$8)

@implementation ImActorModelModulesFileUploadManager_$9

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$callback_)) onNotUploading];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$9 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$9)

@implementation ImActorModelModulesFileUploadManager_$10

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$callback_)) onNotUploading];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0 {
  val$callback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$10 *)other {
  [super copyAllFieldsTo:other];
  other->val$callback_ = val$callback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$10)

@implementation ImActorModelModulesFileUploadManager_$11

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$fileCallback_)) onUploadingWithFloat:val$progress_];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0
                               withFloat:(jfloat)capture$1 {
  val$fileCallback_ = capture$0;
  val$progress_ = capture$1;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$11 *)other {
  [super copyAllFieldsTo:other];
  other->val$fileCallback_ = val$fileCallback_;
  other->val$progress_ = val$progress_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$11)

@implementation ImActorModelModulesFileUploadManager_$12

- (void)run {
  [((id<AMUploadCallback>) nil_chk(val$fileCallback_)) onUploaded];
}

- (instancetype)initWithAMUploadCallback:(id<AMUploadCallback>)capture$0 {
  val$fileCallback_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$12 *)other {
  [super copyAllFieldsTo:other];
  other->val$fileCallback_ = val$fileCallback_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$12)

@implementation ImActorModelModulesFileUploadManager_$13

- (ImActorModelModulesFileUploadTask *)create {
  return [[ImActorModelModulesFileUploadTask alloc] initWithLong:((ImActorModelModulesFileUploadManager_QueueItem *) nil_chk(val$finalPendingQueue_))->rid_ withNSString:val$finalPendingQueue_->fileDescriptor_ withNSString:val$finalPendingQueue_->fileName_ withDKActorRef:[this$0_ self__] withImActorModelModulesModules:[this$0_ modules]];
}

- (instancetype)initWithImActorModelModulesFileUploadManager:(ImActorModelModulesFileUploadManager *)outer$
          withImActorModelModulesFileUploadManager_QueueItem:(ImActorModelModulesFileUploadManager_QueueItem *)capture$0 {
  this$0_ = outer$;
  val$finalPendingQueue_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesFileUploadManager_$13 *)other {
  [super copyAllFieldsTo:other];
  other->this$0_ = this$0_;
  other->val$finalPendingQueue_ = val$finalPendingQueue_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesFileUploadManager_$13)
