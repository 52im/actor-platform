//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/library/actor-cocoa-base/build/java/im/actor/model/modules/DisplayLists.java
//

#include "IOSClass.h"
#include "J2ObjC_source.h"
#include "im/actor/model/droidkit/engine/ListEngine.h"
#include "im/actor/model/droidkit/engine/ListEngineDisplayExt.h"
#include "im/actor/model/entity/Dialog.h"
#include "im/actor/model/entity/Message.h"
#include "im/actor/model/entity/Peer.h"
#include "im/actor/model/modules/BaseModule.h"
#include "im/actor/model/modules/Contacts.h"
#include "im/actor/model/modules/DisplayLists.h"
#include "im/actor/model/modules/Messages.h"
#include "im/actor/model/modules/Modules.h"
#include "im/actor/model/mvvm/BindedDisplayList.h"
#include "im/actor/model/mvvm/MVVMEngine.h"
#include "java/lang/RuntimeException.h"
#include "java/util/HashMap.h"

@interface ImActorModelModulesDisplayLists () {
 @public
  AMBindedDisplayList *dialogGlobalList_;
  AMBindedDisplayList *contactsGlobalList_;
  JavaUtilHashMap *chatsGlobalLists_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesDisplayLists, dialogGlobalList_, AMBindedDisplayList *)
J2OBJC_FIELD_SETTER(ImActorModelModulesDisplayLists, contactsGlobalList_, AMBindedDisplayList *)
J2OBJC_FIELD_SETTER(ImActorModelModulesDisplayLists, chatsGlobalLists_, JavaUtilHashMap *)

@interface ImActorModelModulesDisplayLists_$1 () {
 @public
  ImActorModelModulesDisplayLists *this$0_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesDisplayLists_$1, this$0_, ImActorModelModulesDisplayLists *)

@interface ImActorModelModulesDisplayLists_$2 () {
 @public
  ImActorModelModulesDisplayLists *this$0_;
  AMPeer *val$peer_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesDisplayLists_$2, this$0_, ImActorModelModulesDisplayLists *)
J2OBJC_FIELD_SETTER(ImActorModelModulesDisplayLists_$2, val$peer_, AMPeer *)

@implementation ImActorModelModulesDisplayLists

- (instancetype)initWithImActorModelModulesModules:(ImActorModelModulesModules *)modules {
  if (self = [super initWithImActorModelModulesModules:modules]) {
    chatsGlobalLists_ = [[JavaUtilHashMap alloc] init];
  }
  return self;
}

- (AMBindedDisplayList *)getContactsGlobalList {
  AMMVVMEngine_checkMainThread();
  if (contactsGlobalList_ == nil) {
    contactsGlobalList_ = [self buildNewContactListWithBoolean:YES];
  }
  return contactsGlobalList_;
}

- (AMBindedDisplayList *)getDialogsGlobalList {
  AMMVVMEngine_checkMainThread();
  if (dialogGlobalList_ == nil) {
    dialogGlobalList_ = [self buildNewDialogsListWithBoolean:YES];
  }
  return dialogGlobalList_;
}

- (AMBindedDisplayList *)getMessagesGlobalListWithAMPeer:(AMPeer *)peer {
  AMMVVMEngine_checkMainThread();
  if (![((JavaUtilHashMap *) nil_chk(chatsGlobalLists_)) containsKeyWithId:peer]) {
    (void) [chatsGlobalLists_ putWithId:peer withId:[self buildNewChatListWithAMPeer:peer withBoolean:YES]];
  }
  return [chatsGlobalLists_ getWithId:peer];
}

- (AMBindedDisplayList *)buildNewDialogsListWithBoolean:(jboolean)isGlobalList {
  AMMVVMEngine_checkMainThread();
  id<DKListEngine> dialogsEngine = [((ImActorModelModulesMessages *) nil_chk([((ImActorModelModulesModules *) nil_chk([self modules])) getMessagesModule])) getDialogsEngine];
  if (!([DKListEngineDisplayExt_class_() isInstance:dialogsEngine])) {
    @throw [[JavaLangRuntimeException alloc] initWithNSString:@"Dialogs ListEngine must implement ListEngineDisplayExt for using global list"];
  }
  id<AMBindedDisplayList_BindHook> hook = nil;
  if (isGlobalList) {
    hook = [[ImActorModelModulesDisplayLists_$1 alloc] initWithImActorModelModulesDisplayLists:self];
  }
  AMBindedDisplayList *displayList = [[AMBindedDisplayList alloc] initWithDKListEngineDisplayExt:(id<DKListEngineDisplayExt>) check_protocol_cast(dialogsEngine, @protocol(DKListEngineDisplayExt)) withBoolean:isGlobalList withInt:ImActorModelModulesDisplayLists_LOAD_PAGE withInt:ImActorModelModulesDisplayLists_LOAD_GAP withAMBindedDisplayList_BindHook:hook];
  [displayList initTopWithBoolean:NO];
  return displayList;
}

- (AMBindedDisplayList *)buildNewContactListWithBoolean:(jboolean)isGlobalList {
  AMMVVMEngine_checkMainThread();
  id<DKListEngine> contactsEngine = [((ImActorModelModulesContacts *) nil_chk([((ImActorModelModulesModules *) nil_chk([self modules])) getContactsModule])) getContacts];
  if (!([DKListEngineDisplayExt_class_() isInstance:contactsEngine])) {
    @throw [[JavaLangRuntimeException alloc] initWithNSString:@"Contacts ListEngine must implement ListEngineDisplayExt for using global list"];
  }
  AMBindedDisplayList *contactList = [[AMBindedDisplayList alloc] initWithDKListEngineDisplayExt:(id<DKListEngineDisplayExt>) check_protocol_cast(contactsEngine, @protocol(DKListEngineDisplayExt)) withBoolean:isGlobalList withInt:ImActorModelModulesDisplayLists_LOAD_PAGE withInt:ImActorModelModulesDisplayLists_LOAD_GAP withAMBindedDisplayList_BindHook:nil];
  [contactList initTopWithBoolean:NO];
  return contactList;
}

- (AMBindedDisplayList *)buildNewChatListWithAMPeer:(AMPeer *)peer
                                        withBoolean:(jboolean)isGlobalList {
  AMMVVMEngine_checkMainThread();
  id<DKListEngine> messagesEngine = [((ImActorModelModulesMessages *) nil_chk([((ImActorModelModulesModules *) nil_chk([self modules])) getMessagesModule])) getConversationEngineWithAMPeer:peer];
  if (!([DKListEngineDisplayExt_class_() isInstance:messagesEngine])) {
    @throw [[JavaLangRuntimeException alloc] initWithNSString:@"Conversation ListEngine must implement ListEngineDisplayExt for using global list"];
  }
  id<AMBindedDisplayList_BindHook> hook = nil;
  if (isGlobalList) {
    hook = [[ImActorModelModulesDisplayLists_$2 alloc] initWithImActorModelModulesDisplayLists:self withAMPeer:peer];
  }
  AMBindedDisplayList *chatList = [[AMBindedDisplayList alloc] initWithDKListEngineDisplayExt:(id<DKListEngineDisplayExt>) check_protocol_cast(messagesEngine, @protocol(DKListEngineDisplayExt)) withBoolean:isGlobalList withInt:ImActorModelModulesDisplayLists_LOAD_PAGE withInt:ImActorModelModulesDisplayLists_LOAD_GAP withAMBindedDisplayList_BindHook:hook];
  [chatList initTopWithBoolean:NO];
  return chatList;
}

- (void)copyAllFieldsTo:(ImActorModelModulesDisplayLists *)other {
  [super copyAllFieldsTo:other];
  other->dialogGlobalList_ = dialogGlobalList_;
  other->contactsGlobalList_ = contactsGlobalList_;
  other->chatsGlobalLists_ = chatsGlobalLists_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesDisplayLists)

@implementation ImActorModelModulesDisplayLists_$1

- (void)onScrolledToEnd {
  [((ImActorModelModulesMessages *) nil_chk([((ImActorModelModulesModules *) nil_chk([this$0_ modules])) getMessagesModule])) loadMoreDialogs];
}

- (void)onItemTouchedWithId:(AMDialog *)item {
}

- (instancetype)initWithImActorModelModulesDisplayLists:(ImActorModelModulesDisplayLists *)outer$ {
  this$0_ = outer$;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesDisplayLists_$1 *)other {
  [super copyAllFieldsTo:other];
  other->this$0_ = this$0_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesDisplayLists_$1)

@implementation ImActorModelModulesDisplayLists_$2

- (void)onScrolledToEnd {
  [((ImActorModelModulesMessages *) nil_chk([((ImActorModelModulesModules *) nil_chk([this$0_ modules])) getMessagesModule])) loadMoreHistoryWithAMPeer:val$peer_];
}

- (void)onItemTouchedWithId:(AMMessage *)item {
  if ([((AMMessage *) nil_chk(item)) getSenderId] != [this$0_ myUid]) {
    [((ImActorModelModulesMessages *) nil_chk([((ImActorModelModulesModules *) nil_chk([this$0_ modules])) getMessagesModule])) onInMessageShownWithAMPeer:val$peer_ withLong:[item getRid] withLong:[item getSortDate] withBoolean:NO];
  }
}

- (instancetype)initWithImActorModelModulesDisplayLists:(ImActorModelModulesDisplayLists *)outer$
                                             withAMPeer:(AMPeer *)capture$0 {
  this$0_ = outer$;
  val$peer_ = capture$0;
  return [super init];
}

- (void)copyAllFieldsTo:(ImActorModelModulesDisplayLists_$2 *)other {
  [super copyAllFieldsTo:other];
  other->this$0_ = this$0_;
  other->val$peer_ = val$peer_;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesDisplayLists_$2)
